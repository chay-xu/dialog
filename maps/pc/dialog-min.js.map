{"version":3,"sources":["pc/dialog.js"],"names":["DialogLayer","options","opt","that","this","$","extend","Default","_drag","drag","css","type","$parent","container","length","$el","dialogHtml","addClass","className","_isBody","nodeName","fixed","isMove","_cid","_zIndex","$elArr","beforeFn","apply","init","layers","push","afterFn","_isIE","_isIE6","window","XMLHttpRequest","$doc","document","$win","padding","html","value","title","left","top","src","scrolling","align","animate","animateAlign","winBtn","buttons","name","callback","disabled","focus","closeBtn","onloadFn","shade","shadeClose","unload","delay","opacity","resize","limit","range","lockX","lockY","onStart","onMove","onEnd","support","sort","cid","j","len","each","i","obj","$proxy","$shade","toNumber","maxValue","last","lastIndexOf","parseInt","split","debounce","context","timeout","runIt","clearTimeout","setTimeout","prototype","v","constructor","id","showShade","_shadeHtml","_bindShadeClose","_layerHtml","attr","width","warpperWidth","height","warpperHeight","zIndex","append","_ie6Fix","_topFixed","bind","_ie6SelectFix","_winResize","_dragObj","_size","ph","parentHeight","pw","parentWidth","t","Number","l","_getParentSize","nph","npw","Math","round","_setCss","_shadeCss","_restore","selector","target","isBody","$drag","hide","show","DragDrop","$iframe","iframe","attachEvent","detachEvent","arguments","caller","onload","timer","_autoClose","delegate","$me","parentOffset","offset","closed","close","parent","e","_getContent","_getTitle","_getFoot","content","buttonArr","tit","con","btn","animateCss","cssObj","isTitle","_titHtml","_loadHtml","_iframeHtml","_conHtml","find","_btnHtml","_winBtnHtml","_toNumberW","_toNumberH","_setCssSize","_getWarpperSize","$focus","el","outerWidth","scrollWidth","innerHeight","scrollHeight","z-index","node","display","prev","next","nodeType","style","previousSibling","nextSibling","parentNode","_elemBack","insertBefore","appendChild","icon","isReturn","val","$ele","click","text","opts","msgClass","full","restore","min","Fix","scrollTop","scrollLeft","createElement","cssText","w","conW","overW","_getConWidth","String","indexOf","h","conH","overH","_getConHeight","dt","dl","undefined","innerWidth","clientWidth","clientHeight","outerHeight","children","newTitle","unbind","replaceWith","isdrag","box","console","log","moveTo","setDrag","o","set","disable","contentWindow","write","remove","splice","closeAll","dragdrop","_handleEvent","$target","parents","hasClass","removeClass","diffx","clientX","offsetLeft","diffy","clientY","offsetTop","_getOffSize","getSelection","removeAllRanges","selection","empty","_end","setCapture","preventDefault","_move","dragH","dragW","_init","_getActive","activeElement","contentDocument","elem","$container","mxT","mxR","mxB","mxL","max","position","releaseCapture","enable","dialog","create","load","msg","Dialog","prompt","ok","cancel","confirm","alert","config","define"],"mappings":"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","file":"pc/dialog-min.js","sourcesContent":["/**\r\n * @file dialog plugin\r\n * @author xucaiyu\r\n * @email 569455187@qq.com\r\n * @version 2.0.5\r\n * @date 2015-06-18\r\n * @license MIT License \r\n */\r\n \r\n/** \r\n  * {\r\n  *     type: {string}\r\n  *     contain: {string}\r\n  *     html: {string}\r\n  *     fun: {\r\n  *         ok: {function},\r\n  *         cancel: {function}\r\n  *     }   \r\n  * }\r\n  */\r\n  \r\n;!(function(){  \r\n// function Dialog( options ){\r\n    var _cid = 1,\r\n        _zIndex = 99999900,\r\n        _zIndexc = 999900,\r\n        layers = [],\r\n        _isIE = !-[1,],\r\n        _isIE6 = _isIE && !window.XMLHttpRequest,\r\n        $doc = $( document ),\r\n        $win = $( window ),\r\n        Default = {\r\n            className: '',\r\n            container: 'body',\r\n            // css: {},\r\n            css: { padding: '10px' },\r\n            html: '加载中...',\r\n            value: '',\r\n            title: '信息',\r\n            left: '50%',\r\n            top: '50%',\r\n            src: 'about:blank',\r\n            scrolling: 'auto',\r\n            align: 'center',\r\n            animate: false,\r\n            animateAlign: 'bottom',\r\n            winBtn: true,\r\n            buttons: [\r\n                {\r\n                    name: '确定',\r\n                    callback: function(){},\r\n                    disabled: false,\r\n                    focus: false\r\n                }\r\n                // ,\r\n                // {\r\n                //     name: '取消',\r\n                //     callback: function(){},\r\n                //     disabled: false,\r\n                //     focus: false\r\n                // }\r\n            ],\r\n            closeBtn: function(){},         // 关闭图层执行\r\n            beforeFn: function(){},         // 初始化之前执行函数\r\n            onloadFn: function(){},         // iframe 页面加载完成执行\r\n            afterFn: function(){},          // 初始化之后执行函数\r\n            shade: true,\r\n            shadeClose: false,\r\n            unload: true,\r\n            delay: false,\r\n            opacity: 0.5,\r\n            fixed: false,\r\n            isMove: true,\r\n            resize: true,\r\n            drag: {\r\n                limit: true,\r\n                range: [ 0, 9999, 9999, 0 ],\r\n                // client: false,\r\n                lockX: false,\r\n                lockY: false,\r\n                onStart: function(){},\r\n                onMove: function(){},\r\n                onEnd: function(){}\r\n            }\r\n        },\r\n        dialogHtml;\r\n\r\n    dialogHtml = ''\r\n    // +'<div class=\"xcy-warpper\">'\r\n    +    '<table class=\"xcy-table xcy-warpper\">'\r\n    +        '<tbody>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-tl xcy-resize-item\" id=\"xcy-resize-tl\"></td>'\r\n    +                '<td class=\"xcy-tc xcy-resize-item\" id=\"xcy-resize-tc\"></td>'\r\n    +                '<td class=\"xcy-tr xcy-resize-item\" id=\"xcy-resize-tr\"></td>'\r\n    +            '</tr>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-cl xcy-resize-item\" id=\"xcy-resize-cl\"></td>'\r\n    +                '<td class=\"xcy-cc\">'\r\n    +                    '<div class=\"xcy-layer\">'\r\n    +                    '</div>'\r\n    +                '</td>'\r\n    +                '<td class=\"xcy-cr xcy-resize-item\" id=\"xcy-resize-cr\"></td>'\r\n    +            '</tr>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-bl xcy-resize-item\" id=\"xcy-resize-bl\"></td>'\r\n    +                '<td class=\"xcy-bc xcy-resize-item\" id=\"xcy-resize-bc\"></td>'\r\n    +                '<td class=\"xcy-br xcy-resize-item\" id=\"xcy-resize-br\"></td>'\r\n    +            '</tr>'\r\n    +        '</tbody>'\r\n    +    '</table>';\r\n    // +'</div>';\r\n\r\n    // support unit\r\n    var support = {\r\n        /**\r\n         * layers 层级冒泡 将被点击层提升z-index最高\r\n         * @param {string|number} dialog对象_cid\r\n         */\r\n        sort: function( cid ){\r\n            var len = layers.length,\r\n                j, _cid, _zIndex;\r\n\r\n            for( j = 0; j < len; j++ ){\r\n                // bubble key position\r\n                if( layers[ j ]._cid == cid ){\r\n                    // 如果是最后1位开始重新渲染\r\n                    if( j == len - 1 ){\r\n                        // if no change 如果原始位置就在最后1位立即返回\r\n                        if( !_cid ) return;\r\n                        // change z-inde style\r\n                        $.each( layers, function( i, obj ){\r\n                            obj.$el.css( 'zIndex', obj._zIndex );\r\n                            obj.$proxy.css( 'zIndex', obj._zIndex );\r\n                            obj.$shade && obj.$shade.css( 'zIndex', obj._zIndex );\r\n                        });\r\n\r\n                        return;\r\n                    }\r\n\r\n                    // bubble\r\n                    _cid = layers[ j ];\r\n                    _zIndex = layers[ j+1 ]._zIndex;\r\n\r\n                    layers[ j ] = layers[ j+1 ];\r\n                    layers[ j+1 ] = _cid;\r\n\r\n                    layers[ j ]._zIndex = layers[ j+1 ]._zIndex;\r\n                    layers[ j+1 ]._zIndex = _zIndex;\r\n\r\n                }\r\n                \r\n            }\r\n        },\r\n        /**\r\n         * px and % to value of number\r\n         * @param {string|number} value 转换值\r\n         * @param {string|number} max value 最大值\r\n         * @return {number}\r\n         */\r\n        toNumber: function( value, maxValue ){\r\n            if (!value && value !== 0 || typeof value === 'number') {\r\n                return value;\r\n            }\r\n\r\n            var last = value.length - 1;\r\n            if ( value.lastIndexOf('px') === last - 1 ) {\r\n                value = parseInt(value);\r\n            } else if ( value.lastIndexOf('%') === last ) {\r\n                if( !maxValue ) maxValue = 100;\r\n                value = parseInt( maxValue * value.split('%')[0] / 100 );\r\n            }\r\n\r\n            return value;\r\n        },\r\n        /** \r\n         * window resize ie6~7 bug\r\n         * @param {Function} callback 回调函数 \r\n         * @param {Integer} delay   延迟时间，单位为毫秒(ms)，默认150 \r\n         * @param {Object} context  上下文，即this关键字指向的对象，默认为null \r\n         * @return {Function} \r\n         */ \r\n        debounce: function( callback, delay, context ){\r\n            if (typeof(callback) !== \"function\") {  \r\n                return;  \r\n            }\r\n\r\n            delay = delay || 150;  \r\n            context = context || null;  \r\n            var timeout,\r\n                runIt = function(){\r\n                    callback.apply(context);  \r\n                };  \r\n            return (function(){\r\n                window.clearTimeout(timeout);  \r\n                timeout = window.setTimeout(runIt, delay);  \r\n            });  \r\n        }    \r\n    };\r\n\r\n    function DialogLayer( options ){\r\n        var that = this,\r\n            $el, opt;\r\n\r\n        /**\r\n         * mix param\r\n         * drag css dialog\r\n         */\r\n        \r\n        // // drag\r\n        // var _drag = $.extend( {}, Default.drag, options.drag );\r\n        // // css\r\n        // that.css = $.extend( {}, Default.css, options.css );\r\n        // dialog\r\n        opt = $.extend( true, {}, Default, options );\r\n        var _drag = opt.drag;\r\n        that.css = opt.css;\r\n\r\n        that.options = opt;\r\n        that.type = opt.type;\r\n\r\n        // dialog parent\r\n        // that.$parent = $( opt.fixed ? 'body' : opt.container );\r\n        \r\n        that.$parent = (typeof opt.container === 'string') ? $( opt.container ) : opt.container;\r\n        if( this.$parent.length == 0 ) that.$parent = $('body');\r\n        // dialog warpper\r\n        that.$el =  $( dialogHtml );\r\n        that.$el.addClass( opt.className );\r\n\r\n        // fixed or limit choose\r\n        that._isBody = (this.$parent[0].nodeName == 'BODY');\r\n        if( (opt.fixed && !that._isBody) || that.type == 'msg' ) \r\n            that.options.isMove = false;\r\n\r\n        // private\r\n        that._cid = _cid++;\r\n        that._zIndex = _zIndex++;\r\n\r\n        // type layer id array\r\n        that.$elArr = [];\r\n        // init function 初始化之前执行的自定义函数\r\n        opt.beforeFn.apply( this );\r\n\r\n        that.init( _drag );\r\n        // save global dialog\r\n        layers.push( this );\r\n\r\n        // init function 初始化之后执行的自定义函数\r\n        opt.afterFn.apply( this );\r\n        options = null;\r\n    }\r\n    // dialog\r\n    DialogLayer.prototype = {\r\n        v: '2.0.5',\r\n        constructor: DialogLayer,\r\n        init: function( _drag ){\r\n            var that = this,\r\n                opt = that.options,\r\n                title = opt.title,\r\n                html = opt.html,\r\n                showShade = that.type == 'shade' || opt.shade,\r\n                $el = that.$el,\r\n                resize = opt.resize,\r\n                $tit, id;\r\n\r\n            // shade layer\r\n            if( showShade ){\r\n                id = 'shade-layer-'+ that._cid;\r\n\r\n                that.$elArr.push( '#'+id );\r\n\r\n                // that.shadeEvent( that.parent, id );\r\n                that._shadeHtml( id );\r\n                opt.shadeClose && that._bindShadeClose();\r\n            }\r\n            switch( that.type ){\r\n                case 'load':\r\n                    id = 'load-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( false, html, false );\r\n                    break;\r\n                case 'confirm':\r\n                    id = 'confirm-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'prompt':\r\n                    id = 'prompt-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'alert':\r\n                    id = 'alert-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'msg':\r\n                    id = 'msg-layer-'+ that._cid;\r\n                \r\n                    that._layerHtml( title, html, false );\r\n                    break;\r\n                case 'iframe':\r\n                    id = 'iframe-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, true, false );\r\n                    break;\r\n                default:\r\n                    id = 'page-layer-'+ that._cid;\r\n                \r\n                    that._layerHtml( title, html, false );\r\n            }\r\n            // push id\r\n            that.$elArr.push( '#'+id );\r\n\r\n            // set id\r\n            $el.attr( 'id', id );\r\n\r\n            // append drag proxy\r\n            that.$proxy = $('<div class=\"xcy-proxy xcy-proxy-hidden\"><div class=\"xcy-title xcy-drag\"><span>'+title+'</span></div></div>').css({\r\n                width: that.warpperWidth,\r\n                height: that.warpperHeight,\r\n                top: that.top,\r\n                left: that.left,\r\n                zIndex: that._zIndex\r\n            })\r\n            that.$parent.append( that.$proxy );\r\n\r\n            // container is body\r\n            // if( that.$parent[0].nodeName == 'BODY' ){\r\n                // fixed position\r\n                // layer滚动\r\n                if( opt.fixed ){\r\n                    // parent is body\r\n                    if( that._isBody ){\r\n                        \r\n                        // ie6的固定与相对定位 fixed\r\n                        if( _isIE6 ){\r\n                            that._ie6Fix = that._topFixed( $win );\r\n                            $win.bind( 'scroll', that._ie6Fix );\r\n                        }else{\r\n                            that.$el.addClass( 'xcy-fixed' );\r\n                            that.$proxy.css( 'position', 'fixed' );\r\n                        }\r\n\r\n                    // parent is not body\r\n                    }else{\r\n                        // container fixed\r\n                        that._ie6Fix = that._topFixed( that.$parent );\r\n                        // scroll event\r\n                        that.$parent.bind( 'scroll', that._ie6Fix );\r\n                    }\r\n                }\r\n                // set shade layer the height\r\n                // $( '#shade-layer-' + that._cid ).css( 'height', that.$parent[0].scrollHeight );\r\n            // }\r\n\r\n            // ie6 bug\r\n            if( _isIE6 ){\r\n                // iframe mask ie6 select tag bug\r\n                that._ie6SelectFix();\r\n            }\r\n\r\n            // fixed and no move bind resize event of dialog\r\n            // 窗口大小改变事件\r\n            if( resize && (opt.fixed || !opt.isMove) ){\r\n                that._winResize = function(){\r\n\r\n                    opt.isMove && that._dragObj._size();\r\n                    // 获取layer位置\r\n                    var ph = that.parentHeight - that.warpperHeight,\r\n                        pw = that.parentWidth - that.warpperWidth,\r\n                        t = Number(that.top)/ph,\r\n                        l = Number(that.left)/pw;\r\n\r\n                    // debounce 防止resize执行过于频繁\r\n                    support.debounce( function(){\r\n                        \r\n                        that._getParentSize();\r\n                        // 刷新窗口重新计算layer位置\r\n                        var nph = that.parentHeight - that.warpperHeight,\r\n                            npw = that.parentWidth - that.warpperWidth,\r\n                            top = Math.round( t*nph ),\r\n                            left = Math.round( l*npw );\r\n\r\n                        // set layer css\r\n                        that.$el.css( that._setCss( top, left ) );\r\n                        // set proxy css\r\n                        that.$proxy && that.$proxy.css({\r\n                                top:  top,\r\n                                left: left \r\n                            })\r\n                        // set shade css\r\n                        if( showShade ){\r\n                            that._shadeCss( $( that.$elArr[0] ) );\r\n                        }\r\n                    })();\r\n                    // that.$parent.scroll();\r\n                };\r\n\r\n                if( that._isBody ){\r\n                    $win.bind( 'resize', that._winResize );\r\n                }else{\r\n                    // this.$parent.bind( 'resize', that._winResize );\r\n                }\r\n            }\r\n\r\n            // restore 记住原始大小和位置\r\n            that._restore = {top: that.top, left: that.left, height: that.height, width: that.width };\r\n\r\n            // drag layer move\r\n            if( opt.isMove ){   \r\n                // var timeStep;          \r\n                // set drag value\r\n                $.extend( _drag, {\r\n                    selector: that.$proxy,\r\n                    container: opt.container,\r\n                    fixed: opt.fixed,\r\n                    target: $('.xcy-title', $el),\r\n                    isBody: that._isBody\r\n                })\r\n                _drag.onStart = function( $drag ){\r\n                    // $drag.css({ top: that.top, left: that.left })\r\n                    $el.hide();\r\n                };\r\n                var onMove = _drag.onMove;\r\n                _drag.onMove = function( t, l ){\r\n                    // clearTimeout(timeStep)\r\n                    // showProxy()\r\n                    that.top = t;\r\n                    that.left = l;\r\n                    onMove( t, l );\r\n                };\r\n                _drag.onEnd = function( t, l ){\r\n                    that.$el.css({ top: t, left: l })\r\n                    // set _restore 修改原始位置\r\n                    that._restore.top = t;\r\n                    that._restore.left = l;\r\n                    $el.show();\r\n                };\r\n\r\n                // drag drop init\r\n                that._dragObj = new DragDrop( _drag );\r\n            }\r\n            // 层级冒泡排序\r\n            $el.bind('mousedown', function(){\r\n                // bubble z-index, set drag ladyer z-index\r\n                support.sort( id.split( '-' )[2] );\r\n            })\r\n            \r\n            // 监控加载状态\r\n            if( that.$iframe ){\r\n                var iframe = that.$iframe[0];\r\n                if( iframe.attachEvent ){\r\n                    iframe.attachEvent( \"onload\", function(){\r\n                        opt.onloadFn && opt.onloadFn();\r\n                        iframe.detachEvent( \"onload\", arguments.caller);\r\n                    });\r\n                }else{\r\n                    iframe.onload = function(){\r\n                        opt.onloadFn && opt.onloadFn();\r\n                        iframe.onload = null;\r\n                    };\r\n                }\r\n                // iframe层级冒泡排序\r\n                // $(that.$iframe[0].contentDocument).bind('mousedown', function(){\r\n                //     // bubble z-index, set drag ladyer z-index\r\n                //     that.$el.mousedown();\r\n                // })\r\n            }\r\n\r\n            // auto hidden\r\n            if( opt.delay )\r\n                that.timer = setTimeout( function(){ that._autoClose(); }, typeof opt.delay === 'boolean' ? 1800 : opt.delay );\r\n\r\n            // resize\r\n            $el.addClass('xcy-resize');\r\n            $el.delegate('.xcy-resize-item', 'mousedown', function(){\r\n                var $me = $(this),\r\n                    id = $me.attr('id'),\r\n                    // h = $win.innerHeight(),\r\n                    // w = $win.innerWidth();\r\n                    parentOffset = that.$parent.offset(),\r\n                    parentTop = parentOffset.top,\r\n                    parentLeft = parentOffset.left;\r\n                    // oldLeft = that.left;\r\n                    that.$proxy.css({\r\n                        top: that.top,\r\n                        left: that.left\r\n                    })\r\n\r\n                var offset = that.$proxy.offset(),\r\n                    top = offset.top,\r\n                    left = offset.left,\r\n                    width = that.$proxy.width(),\r\n                    height = that.$proxy.height();\r\n\r\n                    // $(document).bind( 'mousemove', handleResize );\r\n                    // $(document).bind( 'mouseup', unResize)\r\n                    \r\n                    function handleResize( e ){\r\n                        var type = e.type;\r\n\r\n                        // var offset = $proxy.offset(),\r\n                        //     top = offset.top,\r\n                        //     left = offset.left;\r\n\r\n                        // window capture focus\r\n                        if( _isIE ){\r\n                            $me.bind( 'losecapture', that._end );\r\n                            $me[0].setCapture();\r\n                        }else{\r\n                            $doc.bind( 'blur', that._end );\r\n                        }\r\n\r\n                        // clear selected text\r\n                        window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\r\n\r\n                        switch(id){\r\n                            case 'xcy-resize-tl':\r\n                                break;\r\n                            case 'xcy-resize-tc':\r\n                                break;\r\n                            case 'xcy-resize-tr':\r\n                                break;\r\n                            case 'xcy-resize-cl':\r\n                                // console.log(left, oldLeft);\r\n                                if(e.clientX < parentLeft) return;\r\n                                if(e.clientX > left+width-150) return;\r\nconsole.log(left );\r\n                                // var cssPosition = that._dragObj.range(top, e.clientX - parentLeft, width + (left - e.clientX), height) \r\n                                that.$proxy.css({\r\n                                    display: 'block',\r\n                                    left: cssPosition.left,\r\n                                    width: cssPosition.width\r\n                                })\r\n                                // that.resize( (that.width + that.left - e.clientX)+left, that.height, that.top, e.clientX-left)\r\n                                break;\r\n                            case 'xcy-resize-cr':\r\n                                if(e.clientX > that.parentWidth + left-6) return;\r\n                                console.log(e.clientX - that.left);\r\n                                // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n                                break;\r\n                        }\r\n                        \r\n                        // if(e.clientX <= 20) return;\r\n\r\n                        // that.resize( (that.width + that.left - (e.clientX ))+20, that.height, that.top, e.clientX-20)\r\n                        // console.log(that.left, e.clientX, that.$parent.offset().left)\r\n\r\n                        return false;\r\n                    }\r\n\r\n                    function unResize(){\r\n                        $(document).unbind( 'mousemove', handleResize );\r\n                        $(document).unbind( 'mouseup', unResize );\r\n\r\n                        var offset = that.$proxy.position();\r\n                        console.log(offset.top, offset.left, '---++++---')\r\n\r\n                        that.resize( that.$proxy.width(), that.$proxy.height(), offset.top, offset.left, true )\r\n                        that.$proxy.hide();\r\n                    }\r\n            })\r\n\r\n        },\r\n        _autoClose: function(){\r\n            var that = this,\r\n                len = that.$elArr.length - 1;\r\n\r\n            that.closed = true;\r\n\r\n            $.each( that.$elArr, function( i, v ){\r\n                $( v ).animate({opacity: '0'}, 800, function(){ \r\n                    i == len && that.close(); \r\n                });\r\n            });\r\n        },\r\n        _bindShadeClose: function( parent ){\r\n            var that = this,\r\n                $el = $( '.xcy-shade', that.$parent );\r\n\r\n            $el && $el.bind( 'click', function( e ){\r\n                if( that.closed ) return;\r\n                that.close();\r\n            });\r\n        },\r\n        _getContent: function(){\r\n\r\n            return $( '.xcy-content', this.$el );\r\n        },\r\n        _getTitle: function(){\r\n\r\n            return $( '.xcy-title', this.$el );\r\n        },\r\n        _getFoot: function(){\r\n\r\n            return $( '.xcy-foot', this.$el );\r\n        },\r\n        // html render\r\n        _layerHtml: function( title, content, buttonArr ){\r\n            var that = this,\r\n                opt = that.options,\r\n                type = that.type,\r\n                $el = that.$el,\r\n                cssObj = that.css,\r\n                isTitle = title !== false,\r\n                tit, con, btn, winBtn,\r\n                animateCss, animateAlign;\r\n\r\n            opt.title = title;\r\n            // get parent size \r\n            that._getParentSize();\r\n            // title\r\n            if( isTitle ){\r\n                \r\n                tit = that._titHtml( title );\r\n                \r\n                // render title\r\n                $( '.xcy-layer', $el ).append( tit );\r\n            }\r\n\r\n            // content\r\n            if( type == 'load' ){\r\n\r\n                con = that._loadHtml( content );\r\n            }else if( type == 'iframe' ){\r\n                \r\n                con = that._iframeHtml( opt.src );           \r\n            }else{\r\n                if( type == 'prompt' ){\r\n                    con = that._conHtml( '<div class=\"xcy-text\">'\r\n                        + '</div><input class=\"xcy-input\" type=\"text\" value=\\\"' + opt.value + '\\\" />' );\r\n\r\n                    con.find( '.xcy-text' ).html( content );\r\n                }else{\r\n                    con = that._conHtml( content );\r\n                }\r\n\r\n                // 宽高设置xcy-main层\r\n                // 自定义css 设置在xyc-main-inner层\r\n                $( '.xcy-main', con ).css( cssObj ); \r\n            }\r\n\r\n            // render content\r\n            $( '.xcy-layer', $el ).append( con );\r\n\r\n            // append dialog\r\n            // 按钮要焦点 需要先渲染\r\n            that.$parent.append( $el );\r\n\r\n            // buttons element\r\n            if( buttonArr ){\r\n                btn = that._btnHtml( buttonArr );\r\n\r\n                // render buttons\r\n                $( '.xcy-layer', $el ).append( btn );\r\n            }\r\n\r\n            // window controll buttons\r\n            if( type !== 'load' && opt.closeBtn ){\r\n                winBtn = that._winBtnHtml( type );\r\n                // render window buttons\r\n                $( '.xcy-layer', $el ).append( winBtn );\r\n\r\n            }   \r\n            // 转换宽高为数字\r\n            that._toNumberW( opt.width );\r\n            that._toNumberH( opt.height );      \r\n\r\n            // set content css\r\n            that._setCssSize( that._getContent() );\r\n\r\n            // get warpper size\r\n            that._getWarpperSize( $el );\r\n\r\n            // set warpper css position\r\n            if( opt.animate ){\r\n                animateCss = {};\r\n                animateAlign = opt.animateAlign;\r\n                // console.log(that.warpperWidth, that.parentWidth)\r\n                if( animateAlign == 'bottom' ){\r\n                    animateCss = {\r\n                        top: that.parentHeight + that.warpperHeight,\r\n                        left: support.toNumber(opt.left, that.parentWidth - that.warpperWidth)\r\n                    }\r\n                }else if( animateAlign == 'top' ){\r\n                    animateCss = {\r\n                        top: -that.parentHeight,\r\n                        left: support.toNumber(opt.left, that.parentWidth - that.warpperWidth)\r\n                    }\r\n                }else if( animateAlign == 'left' ){\r\n                    animateCss = {\r\n                        top: support.toNumber(opt.top, that.parentHeight - that.warpperHeight),\r\n                        left: -that.warpperWidth\r\n                    }\r\n                }else if( animateAlign == 'right' ){\r\n                    animateCss = {\r\n                        top: support.toNumber(opt.top, that.parentHeight - that.warpperHeight),\r\n                        left: that.parentWidth + that.warpperWidth\r\n                    }\r\n                }\r\n                $el.css( animateCss );\r\n\r\n                $el.animate( that._setCss(opt.top, opt.left), opt.delay );\r\n            }else{\r\n                $el.css( that._setCss(opt.top, opt.left), opt.delay );\r\n            }\r\n\r\n            // button focus\r\n            try {\r\n                if( buttonArr ) that.$focus.focus();\r\n            }catch( e ){}\r\n        },\r\n        // shade html\r\n        _shadeHtml: function( id ){\r\n            var that = this,\r\n                shade = $( '<div class=\"xcy-shade\" id=\\\"'+ id +'\\\"></div>' );\r\n\r\n            that._shadeCss( shade );\r\n            that.$shade = shade;\r\n            // set id\r\n            // shade.css( { width: width, height: height, opacity: opacity, 'z-index': that._zIndex } );\r\n\r\n            that.$parent.append( shade );\r\n        },\r\n        _shadeCss: function( el ){\r\n            var that = this,\r\n                opacity = that.options.opacity,\r\n                isBody = that._isBody,\r\n                width = isBody ? $('body').outerWidth() : that.$parent[0].scrollWidth,\r\n                height = isBody ? $doc.innerHeight() : that.$parent[0].scrollHeight;\r\n\r\n            // that._getParentSize();\r\n            // set shade css\r\n            el.css( { width: width, height: height, opacity: opacity, 'z-index': that._zIndex } );\r\n        },\r\n        // load html\r\n        _loadHtml: function( html ){\r\n            var that = this,\r\n                opt = that.options,\r\n                node = $( '<div class=\"xcy-load\"><span class=\"xcy-load-img\"></span><span>'+html+'</span></div>' );\r\n\r\n            // 转换宽高为数字\r\n            that._toNumberW( opt.width );\r\n            that._toNumberH( opt.height ); \r\n            // set content css\r\n            that._setCssSize( node );\r\n\r\n            return node;\r\n        },\r\n        _iframeHtml: function( src ){\r\n            var that = this,\r\n                opt = that.options,\r\n                $iframe = $('<iframe allowtransparency=\"true\" frameborder=\"0\" class=\"xcy-iframe\" name=\"xcy-iframe-' \r\n                    + that._cid +'\"  src=\"'+src+'\" scrolling=\"'+opt.scrolling+'\"></iframe>');\r\n\r\n                // 添加 iframe 对象\r\n                that.$iframe = $iframe;\r\n\r\n            return that._conHtml( '' ).html( $iframe );\r\n        },\r\n        // content html\r\n        _conHtml: function( html ){\r\n            var that = this,\r\n                opt = that.options,\r\n                node = $( '<div class=\"xcy-content\"><div class=\"xcy-main\"></div></div>' ),\r\n                display, prev, next, parent;\r\n\r\n            // element remove save node info \r\n            if( html && html.nodeType === 1 ){\r\n                display = html.style.display;\r\n                prev = html.previousSibling;\r\n                next = html.nextSibling;\r\n                parent = html.parentNode;\r\n                that._elemBack = function () {\r\n                    if (prev && prev.parentNode) {\r\n                        prev.parentNode.insertBefore( html, prev.nextSibling);\r\n                    } else if (next && next.parentNode) {\r\n                        next.parentNode.insertBefore( html, next);\r\n                    } else if (parent) {\r\n                        parent.appendChild( html );\r\n                    }\r\n                    html.style.display = display;\r\n                    that._elemBack = null;\r\n                };\r\n            }\r\n\r\n            // set content html\r\n            node.find( '.xcy-main' ).html( html );\r\n            // add icon\r\n            if( opt.icon ){\r\n                node.addClass('xcy-icon-box')\r\n                node.append('<div class=\"xcy-icon-default xcy-icon-'+opt.icon+'\"></div>')\r\n            }\r\n\r\n            return node;\r\n        },\r\n        // title html\r\n        _titHtml: function( title ){\r\n            var that = this,\r\n                node = $( '<div class=\"xcy-title\"></div>' );\r\n\r\n            node.append( '<span title=\\\"'+ title +'\\\">'+ title +'</span>' );\r\n\r\n            return node;\r\n        },\r\n        // button html\r\n        _btnHtml: function( buttonArr ){\r\n            var that = this,\r\n                node = $( '<div class=\"xcy-foot\"></div>' ),\r\n                html = '',\r\n                len = buttonArr.length - 1;\r\n\r\n            // button html\r\n            $.each( buttonArr, function( i, v ){\r\n                var disabled = v.disabled ? 'disabled' : '',\r\n                    className = '';\r\n                if( i === 0 ){\r\n                    className = 'xcy-btn-r';\r\n                }else if( i == len ){\r\n                    className = 'xcy-btn-l';\r\n                }else{\r\n                    className = 'xcy-btn-m';\r\n                }\r\n                html += '<button class=\"xcy-btn '+ className +'\" type=\"button\" '+ disabled +'>'+ v.name +'</button>';\r\n            });\r\n\r\n            // button html\r\n            node.html( html );\r\n            // text align direction\r\n            node.css( 'text-align', that.options.align );\r\n\r\n            // bind callback event\r\n            $( 'button', node ).each(function(i){\r\n                var $ele = $( this ),\r\n                    obj = buttonArr[ i ],\r\n                    isReturn, callback, val;\r\n\r\n                $ele.click(function( e ){\r\n                    callback = obj.callback;\r\n                    val = $( '.xcy-input', that._getContent() ).val();\r\n\r\n                    // return callback\r\n                    if( callback ) isReturn = callback( $ele.text(), val );\r\n\r\n                    if( isReturn === false ){\r\n                        return;\r\n                    }else{\r\n                        that.close();\r\n                    }\r\n                });\r\n\r\n                // focus\r\n                if( obj.focus && !obj.disabled ){\r\n                    that.$focus = $ele;\r\n                }\r\n            })\r\n\r\n            return node;\r\n        },\r\n        _winBtnHtml: function( type ){\r\n            var that = this,\r\n                opts = that.options,\r\n                closeBtn = opts.closeBtn,\r\n                winBtn = opts.winBtn,\r\n                node = $( '<div class=\"xcy-winBtn\"></div>' ),\r\n                state = true,\r\n                msgClass = 'xcy-close-btn';\r\n\r\n            // min max\r\n            if( type == 'iframe' && winBtn ){\r\n                node.append( '<a class=\"xcy-winBtn-btn\" id=\"xcy-min-btn\" href=\"javascript:;\">-</a>' );\r\n                node.append( '<a class=\"xcy-winBtn-btn\" id=\"xcy-full-btn\" href=\"javascript:;\">+</a>' );\r\n            }\r\n            // if type is msg or page, change close class\r\n            if( ( type == 'msg' && opts.title === false ) || (type == 'page' && opts.title === false) )\r\n                msgClass = 'xcy-x-btn';\r\n            \r\n            // close\r\n            node.append( '<a class=\"xcy-winBtn-btn\"  id=\\\"'+ msgClass +'\\\" href=\"javascript:;\">×</a>' );\r\n\r\n            $( 'a', node ).bind( 'click', function( e ){\r\n                var id = $( this ).attr( 'id' ),\r\n                    isReturn = true;\r\n\r\n                switch( id ){\r\n                    case 'xcy-close-btn':\r\n                    case 'xcy-x-btn':\r\n                        // return callback\r\n                        if( closeBtn ) isReturn = closeBtn( that.title() );\r\n\r\n                        if( isReturn === false ){\r\n                            return;\r\n                        }else{\r\n                            that.close();\r\n                        }\r\n                        break;\r\n                    case 'xcy-full-btn':\r\n                        // if( state ){\r\n                            that.full();\r\n                            $( this ).attr( 'id', 'xcy-restore-btn' )\r\n                            $( '#xcy-min-btn', that.$el ).show();\r\n                            // state = false;\r\n                        // }else{\r\n                        //     $( '#xcy-min-btn', that.$el ).show();\r\n                        //     that.restore();\r\n                        //     state = true;\r\n                        // }\r\n                        break;\r\n                    case 'xcy-restore-btn':\r\n                        that.restore();\r\n                        $( this ).attr( 'id', 'xcy-full-btn' )\r\n                        $( '#xcy-min-btn', that.$el ).show();\r\n                        break;\r\n                    case 'xcy-min-btn':\r\n                        $( this ).hide();\r\n                        that.min();\r\n                        $( this ).next().attr( 'id', 'xcy-restore-btn' )\r\n                        break;\r\n                }\r\n            });\r\n\r\n            return node;\r\n        },\r\n        _topFixed: function( parent ){\r\n            var that = this,\r\n                _top, Fix;\r\n\r\n            // client top\r\n            Fix = function(){\r\n                \r\n                support.debounce( function(){\r\n                    that.$el.css({\r\n                        top: that.top + parent.scrollTop(),\r\n                        left: that.left + parent.scrollLeft()\r\n                    })\r\n                    // that.$el.animate({\r\n                    //     top: that.top + parent.scrollTop(),\r\n                    //     left: that.left + parent.scrollLeft()\r\n                    // })  \r\n                })();\r\n            };\r\n\r\n            return Fix;\r\n        },\r\n        // ie6 select not mask with div tag\r\n        _ie6SelectFix: function(){\r\n            var that = this,\r\n                $el = that.$el,\r\n                width = that.warpperWidth,\r\n                height = that.warpperHeight,\r\n                iframe;\r\n\r\n            // iframe = $el.append(document.createElement('iframe'));\r\n            iframe = document.createElement('iframe');\r\n            iframe.src = 'about:blank;';\r\n            iframe.style.cssText = 'position:absolute;z-index:-1;left:0;top:0;'\r\n            + 'filter:alpha(opacity=0);border:0 none;width:' + width + 'px;height:' + height +'px;';\r\n\r\n            $el.append( iframe );\r\n        },\r\n        // 宽度百分比转换数字\r\n        _toNumberW: function( w ){\r\n            var that = this,\r\n                conW, //内容宽\r\n                overW;\r\n\r\n            // warpper 大小\r\n            that._getWarpperSize( that.$el );\r\n\r\n            that._getConWidth();\r\n           \r\n            // % percent conver to number\r\n            if( w ){\r\n                if( String(w).indexOf('%') !== -1 ){\r\n                    conW = that.width;\r\n                    overW = that.warpperWidth - conW;\r\n                    w = support.toNumber( w, that.parentWidth -overW );\r\n                }\r\n                that.width = Number(w);\r\n            }\r\n        },\r\n        // 高度百分比转换数字\r\n        _toNumberH: function( h ){\r\n            var that = this,\r\n                conH, //内容宽\r\n                overH;\r\n\r\n            // warpper 大小\r\n            that._getWarpperSize( that.$el );\r\n\r\n            that._getConHeight();\r\n\r\n            // % percent conver to number\r\n            if( h ){\r\n                if( String(h).indexOf('%') !== -1 ){\r\n                    conH = that.height;\r\n                    overH = that.warpperHeight - conH;\r\n                    h = support.toNumber( h, that.parentHeight -overH );\r\n                }\r\n                that.height = Number(h);\r\n            }\r\n        },\r\n        // set content css\r\n        _setCssSize: function( el ){\r\n            var that = this,\r\n                cssObj = that.css;\r\n\r\n            // 宽高分开渲染，不然高度受宽度影响获取值不对\r\n            // that._toNumberW( w );\r\n            el.css( { width: that.width, height: that.height } );\r\n\r\n            // that._toNumberH( h );\r\n            // el.css( { height: that.height } );\r\n        },\r\n        // set warpper css\r\n        _setCss: function( t, l ){\r\n            var that = this,\r\n                opt = that.options,\r\n                $parent = that.$parent,\r\n                isBody = that._isBody,\r\n                dt = 0,\r\n                dl = 0,\r\n                cssObj = {};\r\n\r\n            if( opt.fixed && _isIE6 ){\r\n                dt = isBody ? $doc.scrollTop() : that.$parent.scrollTop();\r\n                dl = isBody ? $doc.scrollLeft() : that.$parent.scrollLeft();\r\n            }\r\n\r\n            // top\r\n            if( t === undefined || t === '' ){\r\n                t = '50%';\r\n            }\r\n            // top % to number\r\n            t = support.toNumber( t, that.parentHeight - that.warpperHeight );\r\n            that.top = t;\r\n\r\n            // left\r\n            if( l === undefined || l === '' ){\r\n                l = '50%';\r\n            }\r\n            // left % to number\r\n            l = support.toNumber( l, that.parentWidth - that.warpperWidth );\r\n            that.left = l;\r\n\r\n            cssObj[ 'z-index' ] = that._zIndex;\r\n\r\n            cssObj[ 'top' ] = t + dt;\r\n            cssObj[ 'left' ] = l + dl;\r\n\r\n            return cssObj;\r\n        },\r\n        // 获取dialog content容器宽度\r\n        _getConWidth: function(){\r\n            var that = this;\r\n\r\n            that.width = that._getContent().width();\r\n        },\r\n        // 获取dialog content容器高度\r\n        _getConHeight: function(){\r\n            var that = this;\r\n\r\n            that.height = that._getContent().height();\r\n        },\r\n        // 获取dialog父级可视大小\r\n        _getParentSize: function(){\r\n            var that = this,\r\n                opt = that.options,\r\n                $parent = that.$parent,\r\n                isBody = that._isBody;\r\n\r\n            // this.parentWidth = isClient ? ( document.documentElement.clientWidth || document.body.clientWidth ) : $parent[0].clientWidth;\r\n            // this.parentHeight = isClient ? ( document.documentElement.clientHeight || document.body.clientHeight ) : $parent[0].clientHeight;\r\n            that.parentWidth = isBody ? $win.innerWidth() : $parent[0].clientWidth;\r\n            that.parentHeight = isBody ? $win.innerHeight() : $parent[0].clientHeight;\r\n        },\r\n        // 获取dialog大小\r\n        _getWarpperSize: function( el ){\r\n            this.warpperWidth = el.outerWidth();\r\n            this.warpperHeight = el.outerHeight();\r\n        },\r\n        min: function(){\r\n\r\n            this.resize( '180', '0', this.top, this.left );\r\n        },\r\n        full: function(){\r\n\r\n            this.resize( '100%', '100%', 0, 0 );\r\n        },\r\n        restore: function(){\r\n            var that = this,\r\n                restore = that._restore;\r\n\r\n            that.resize( restore.width, restore.height, restore.top, restore.left );\r\n        },\r\n        title: function( title ){\r\n            var el = this._getTitle().children( 'span' );\r\n\r\n            var newTitle = title ? el.html( title ) : el.html();\r\n\r\n            return title ? this : newTitle;\r\n        },\r\n        html: function( html ){\r\n            this._getContent().html( html );\r\n\r\n            return this;\r\n        },\r\n        buttons: function( buttonArr ){\r\n            $( 'button', this.$el ).unbind( 'click' );\r\n            this._getFoot().replaceWith( this._btnHtml( buttonArr ) );\r\n\r\n            return this;\r\n        },\r\n        resize: function( w, h, t, l, isdrag ){\r\n            var that = this,\r\n                offL = parseInt( that.$el.css( 'left' ) ),  //left\r\n                offT = parseInt( that.$el.css( 'top' ) ),\r\n                conW, conH, //内容宽\r\n                diffH, diffW,\r\n                overH, overW,\r\n                left, top, box;\r\n\r\n            // restore\r\n            // that._restore = {top: that.top, left: that.left, height: that.height, width: that.width };\r\n\r\n            // 宽高转换数字\r\n            that._toNumberW( w );\r\n            that._toNumberH( h );\r\n\r\n            conW = that.width, //内容宽\r\n            conH = that.height,\r\n\r\n            this.options.height = h;\r\n            this.options.width = w;            \r\n\r\n            // 除内容外的宽度/2\r\n            // diffW = (conW - w)/2;\r\n            // diffH = (conH - h)/2;\r\n            // // exist l and t 指定位置\r\n            // // no exist [ offL + diffW ]\r\n            // left = l !== undefined ? l : offL + diffW;\r\n            // top = t !== undefined ? t : offT + diffH;\r\n           \r\n            // t = that.oTop;\r\n            // l = that.oLeft;\r\n            \r\n// console.log( that._restore );\r\n\r\n            // set content css\r\n            that._setCssSize( that._getContent() );\r\n            // reset warpper size\r\n            that._getWarpperSize( that.$el );\r\n            // exist l and t 指定位置\r\n            // no exist [ offL + diffW ]\r\n            box = that._setCss( t, l );\r\n            top = box.top;\r\n            left = box.left;\r\n\r\n            that.$proxy.css({\r\n                left: left,\r\n                top: top,\r\n                width: that.warpperWidth,\r\n                height: that.warpperHeight\r\n            })\r\n\r\n            // move positon\r\n            // if( !this._dragObj || isdrag ){\r\n                console.log( top, left, that.warpperHeight, that.warpperWidth )\r\n                // that.$el.css( that._setCss( top, left ) );\r\n                that.$el.css({\r\n                    top: top,\r\n                    left: left\r\n                });\r\n            // }else{\r\n                // that._dragObj._move( top, left, that.warpperHeight, that.warpperWidth );\r\n                // that._dragObj._end( top, left );\r\n            // }\r\n\r\n            return this;\r\n        },\r\n        moveTo: function( t, l ){\r\n            var that = this;\r\n\r\n            // % percent conver to number\r\n            t = support.toNumber( t, that.parentHeight );\r\n            l = support.toNumber( l, that.parentWidth );\r\n\r\n            // get drag layer limit range\r\n            if( !this._dragObj ){\r\n                box = that._setCss( t, l );\r\n            }else{\r\n                box = that._dragObj.range( t, l, that.warpperWidth, that.warpperHeight );\r\n            }\r\n\r\n            // set warpper css\r\n            that.$el.css( that._setCss( box.top, box.left ) );\r\n\r\n            return this;\r\n        },\r\n        setDrag: function( o ){\r\n            if( !this._dragObj ) return this;\r\n\r\n            this._dragObj.set( o );\r\n\r\n            return this;\r\n        },\r\n        hide: function(){\r\n            $.each( this.$elArr, function( i, v ){\r\n                $( v ).hide();\r\n            })\r\n\r\n            return this;\r\n        },\r\n        show: function(){\r\n            $.each( this.$elArr, function( i, v ){\r\n                $( v ).show();\r\n            })\r\n\r\n            return this;\r\n        },\r\n        close: function(){\r\n            var that = this;\r\n\r\n            if( that.timer ){\r\n                clearTimeout( that.timer )\r\n                that.timer = null;\r\n            }\r\n            that.closed = null;\r\n\r\n            // not unload\r\n            if( !that.options.unload ){\r\n                that.hide();\r\n                return;\r\n            }\r\n\r\n            // unload\r\n            that.unload();\r\n        },\r\n        unload: function(){\r\n            var that = this, t;\r\n\r\n            // unbind input buttons click event\r\n            $( 'button', that.$el ).unbind( 'click' );\r\n            $( '.xcy-winBtn a', that.$el ).unbind( 'click' );\r\n            that.$el.unbind( 'mousedown' );\r\n\r\n            // unbind window event\r\n            if( that._winResize ){\r\n                $win.unbind( 'resize', that._winResize );\r\n            }\r\n            if( that._ie6Fix ){\r\n                $win.unbind( 'scroll', that._ie6Fix );\r\n                that.$parent.unbind( 'scroll', that._ie6Fix ); \r\n            }\r\n            \r\n            // unbind shade\r\n            that.options.shadeClose && $( '.xcy-shade', that.$parent ).unbind( 'click' );\r\n\r\n            // unbind drag click event\r\n            that.options.isMove && that._dragObj.disable();\r\n            // if html is element, back move position\r\n            that._elemBack && that._elemBack();\r\n\r\n            // 低版本ie 内存回收 iframe\r\n            if( that.type === 'iframe' ){\r\n                try {\r\n                    var iframe = that.$iframe[0];\r\n                    iframe.contentWindow.document.write('');\r\n                    iframe.contentWindow.close();\r\n                    that.$iframe.remove();\r\n                } catch(e){}\r\n            }\r\n            // remove dom\r\n            $.each( that.$elArr, function( i, v ){\r\n                $( v ).remove();\r\n            })\r\n            that.$elArr = null;\r\n\r\n            // delete global array object\r\n            t = layers.length;\r\n            while( t-- ){\r\n                if( layers[ t ]._cid === this._cid ){\r\n                    layers.splice( t, 1 );\r\n                }\r\n            }\r\n\r\n        },\r\n        closeAll: function(){\r\n            $.each( layers, function( i, v ){\r\n                v.close();\r\n            })\r\n        }\r\n    }\r\n\r\n    // drag layer\r\n    var DragDrop = (function( options ){\r\n\r\n        /**\r\n         * [dragdrop description]\r\n         * @param  {[type]} options [description]\r\n         * @return {[type]}         [description]\r\n         */\r\n        function dragdrop( options ){\r\n            var that = this;\r\n\r\n            that.diffx = 0;\r\n            that.diffy = 0;\r\n            that.options = options;\r\n            that.$drag = typeof options.selector === 'string' ? $( options.selector ) : options.selector;\r\n            that.$target = typeof options.selector === 'string' ? $( options.target ) : options.target;\r\n            that._handleEvent = _handleEvent;\r\n\r\n            that._init();\r\n\r\n            // handle event\r\n            function _handleEvent( e ){\r\n                var type = e.type,\r\n                    _self = that,\r\n                    $target = $( e.target ),\r\n                    className = that.$target.attr('class'),\r\n                    $el;\r\n\r\n                // target is tit childer\r\n                if( $target.parents( '.xcy-drag' ).length !== 0 ){\r\n                    $el = $target.parents( '.xcy-drag' );\r\n                // target is tit\r\n                }else{\r\n                    $el = $target;\r\n                }\r\n\r\n                switch( type ){\r\n                    case 'mousedown':\r\n                        // bind start event\r\n                        that.options.onStart( that.$drag );\r\n\r\n                        if( $el.hasClass( 'xcy-drag' ) ){\r\n\r\n                            that.$drag.removeClass('xcy-proxy-hidden');\r\n                            // console.log(that.$target[0].getBoundingClientRect())\r\n                            // mouse clientx - drag layer offset left\r\n                            that.diffx = e.clientX - that.$drag[0].offsetLeft;\r\n                            that.diffy = e.clientY - that.$drag[0].offsetTop;\r\n                            // afresh size\r\n                            that._getOffSize();\r\n                   \r\n                            // clear selected text\r\n                            window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\r\n                            \r\n                            // window capture focus\r\n                            if( _isIE ){\r\n                                that.$drag.bind( 'losecapture', that._end );\r\n                                that.$drag[0].setCapture();\r\n                            }else{\r\n                                $doc.bind( 'blur', that._end );\r\n                            }\r\n\r\n                            $doc.bind( 'mousemove', that._handleEvent );\r\n                            $doc.bind( 'mouseup', that._handleEvent );\r\n\r\n                            e.preventDefault();\r\n                        }\r\n                        break;\r\n                    case 'mousemove':\r\n                        var l = e.clientX - that.diffx,\r\n                            t = e.clientY - that.diffy;\r\n\r\n                        that._move( t, l, that.dragH, that.dragW );\r\n\r\n                        e.preventDefault();\r\n                        break;\r\n                    case 'mouseup':\r\n                        // dragable proxy hidden\r\n                        that.$drag.addClass('xcy-proxy-hidden');\r\n\r\n                        that._end();\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        dragdrop.prototype = {\r\n            _init: function(){\r\n                var that = this;\r\n\r\n                that._size();\r\n\r\n                // $tit.attr( 'data-move', 'true' );\r\n                // $tit.css( 'cursor', 'move' );\r\n                that.$target.addClass( 'xcy-drag' );\r\n                // mousedown event\r\n                that.$target.bind( 'mousedown', that._handleEvent );\r\n            },\r\n            _getActive: function () {\r\n                try {// try: ie8~9, iframe bug\r\n                    var activeElement = document.activeElement,\r\n                        contentDocument = activeElement.contentDocument,\r\n                        elem = contentDocument && contentDocument.activeElement || activeElement;\r\n                    return elem;\r\n                } catch (e) {}\r\n            },\r\n            _size: function(){\r\n                var that = this,\r\n                    opt = that.options,\r\n                    range = opt.range,\r\n                    $container;\r\n\r\n                // limit range\r\n                if( !opt.limit ) return;\r\n\r\n                that.mxT = range[0];\r\n                that.mxR = range[1] !== undefined ? range[1] : range[0];\r\n                that.mxB = range[2] !== undefined ? range[2] : range[0];\r\n                that.mxL = range[3] !== undefined ? range[3] : range[1] ? range[1] : range[0];\r\n\r\n                // that.marginL = parseInt( that.$parent.css( 'marginLeft' ) );\r\n                // that.marginT = parseInt( that.$parent.css( 'marginTop' ) );\r\n\r\n                that._getOffSize();\r\n\r\n                // container\r\n                // if( opt.container ){\r\n                    // $container = opt.fixed ? $( 'body' ) : $( opt.container );\r\n                    $container = $( opt.container );\r\n\r\n                    // client element 可视范围dom对象\r\n                    if( !opt.fixed && opt.isBody ){\r\n                        // scroll range value值\r\n                        that.h = $doc.outerHeight();\r\n                        that.w = $doc.outerWidth();\r\n\r\n                    }else if( opt.fixed && opt.isBody ){\r\n                        that.h = $win.innerHeight();\r\n                        that.w = $win.innerWidth();\r\n\r\n                    }else{\r\n                        // client range value值\r\n                        that.h = $container[0].scrollHeight;\r\n                        that.w = $container[0].scrollWidth;\r\n                    }\r\n\r\n                    // container css style position\r\n                    $container.css( 'position' ) == 'relative' && $container.css( 'position', 'relative' );\r\n\r\n                // }\r\n\r\n                // lock x axis\r\n                if( opt.lockX ) that.mxR = that.mxL = that.left;\r\n                // lock y axis\r\n                if( opt.lockY ) that.mxT = that.mxB = that.top;\r\n            },\r\n            _getOffSize: function(){\r\n                var that = this;\r\n\r\n                // get parent width and height value\r\n                that.dragW = that.$drag.outerWidth();\r\n                that.dragH = that.$drag.outerHeight();\r\n                // left top\r\n                that.left = parseInt( that.$drag.css( 'left' ) );\r\n                that.top = parseInt( that.$drag.css( 'top' ) );\r\n\r\n                // reprai 修正右下limit range值\r\n                // limit right值: 右限制最大值\r\n                // limit left值 + 拖动容器width值: 右限制范围最小值\r\n                that.mxR = Math.max( that.mxR, that.mxL + that.dragW );\r\n                that.mxB = Math.max( that.mxB, that.mxT + that.dragH );\r\n            },\r\n            _move: function( t, l, dragH, dragW ){\r\n                var that = this,\r\n                    position, left, top;\r\n\r\n                // left and top value\r\n                position = that.range( t, l, dragW, dragH );\r\n                left = position.left;\r\n                top = position.top;\r\n\r\n                that.$drag.css( { 'left': left, 'top': top } );\r\n                that.left = left;\r\n                that.top = top;\r\n\r\n                that.options.onMove( top, left );\r\n            },\r\n            // drag end, unbind event\r\n            _end: function(){\r\n                var that = this;\r\n\r\n                $doc.unbind( 'mousemove', that._handleEvent );\r\n                $doc.unbind( 'mouseup', that._handleEvent );\r\n\r\n                if( _isIE ){\r\n                    that.$drag.unbind( 'losecapture', that._end );\r\n                    that.$drag[0].releaseCapture();\r\n                }else{\r\n                    $doc.unbind( 'blur', that._end );\r\n                }\r\n\r\n                that.options.onEnd(that.top, that.left);\r\n            },\r\n            range: function( t, l, dragW, dragH ){\r\n                var that = this,\r\n                    opt = that.options,\r\n                    obj = {},\r\n                    mxT, mxR, mxL, mxB;\r\n\r\n                // scroll top\r\n                // if( !opt.fixed ){\r\n                //     st = $doc.scrollTop();\r\n                //     sl = $doc.scrollLeft();\r\n                // }\r\n\r\n                if( opt.limit ){\r\n\r\n                    mxT = that.mxT;\r\n                    mxR = that.mxR;\r\n                    mxL = that.mxL;\r\n                    mxB = that.mxB;\r\n\r\n                    if( opt.container ){\r\n                        // [ limit range , container range ] 容器最小活动范围\r\n                        mxT = Math.max( that.mxT, 0 );\r\n                        mxR = Math.min( that.w - dragW, that.mxR - dragW );\r\n                        mxL = Math.max( that.mxL, 0 );\r\n                        mxB = Math.min( that.h - dragH, that.mxB - dragH );\r\n                    }\r\n\r\n                    // 获取drag时正确的范围值\r\n                    l = Math.max(Math.min( l, mxR ), mxL );\r\n                    t = Math.max(Math.min( t, mxB ), mxT );\r\n                }\r\n\r\n                obj.left = l;\r\n                obj.top = t;\r\n                obj.width = dragW;\r\n                obj.height = dragH;\r\n\r\n                return obj;\r\n            },\r\n            // set attribute options\r\n            set: function( options ){\r\n                var that = this;\r\n\r\n                options && $.extend( that.options, options );\r\n                that._size();\r\n            },\r\n            // bind event\r\n            enable: function(){\r\n                var that = this;\r\n\r\n                that.$drag.bind( 'mousedown', that._handleEvent );\r\n            },\r\n            // unbind event\r\n            disable: function(){\r\n                var that = this;\r\n\r\n                that.$drag.unbind( 'mousedown', that._handleEvent ); \r\n            }\r\n        }\r\n\r\n        return dragdrop;\r\n\r\n    })();\r\n\r\n    var dialog = {\r\n        create: function( options ){\r\n            var dl = new DialogLayer( options );\r\n            // save global dialog\r\n            // layers.push( dl );\r\n            return dl;\r\n        },\r\n        load: function( msg, delay, shade, shadeClose ){\r\n            // delay is not exist\r\n            return Dialog.create({\r\n                type: 'load',\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: shade || false,\r\n                shadeClose: shadeClose || true,\r\n                delay: typeof delay !== 'undefined' ? delay : false\r\n            })\r\n        },\r\n        prompt: function( msg, val, ok, cancel ){\r\n            return Dialog.create({\r\n                type: 'prompt',\r\n                html: msg,\r\n                value: val,\r\n                fixed: true,\r\n                width: 300,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: ok,\r\n                        disabled: false,\r\n                        focus: true\r\n                    },\r\n                    {\r\n                        name: '取消',\r\n                        callback: cancel,\r\n                        disabled: false,\r\n                        focus: false\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        confirm: function( msg, ok, cancel ){\r\n\r\n            return Dialog.create({\r\n                type: 'confirm',\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: ok,\r\n                        disabled: false,\r\n                        focus: true\r\n                    },\r\n                    {\r\n                        name: '取消',\r\n                        callback: cancel,\r\n                        disabled: false,\r\n                        focus: false\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        alert: function( msg, title, callback ){\r\n            // title is not exist\r\n            if( typeof title === 'function' ){\r\n                callback = title;\r\n                title = '信息';\r\n            }\r\n\r\n            return Dialog.create({\r\n                type: 'alert',\r\n                html: msg,\r\n                fixed: true,\r\n                title: title,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: callback,\r\n                        disabled: false,\r\n                        focus: true\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        msg: function( msg, delay, shade ){\r\n            // delay is not exist\r\n            delay = typeof delay !== 'undefined' ? delay : true;\r\n\r\n            return Dialog.create({\r\n                type: 'msg',\r\n                title: false,\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: shade || false,\r\n                closeBtn: !delay ? function(){} : false,\r\n                delay: delay,\r\n                isMove: false\r\n            })\r\n        },\r\n        // config default param\r\n        config: function( config ){\r\n            return $.extend( Default, config );\r\n        }\r\n    }\r\n\r\n    'function' === typeof define? define(function(){\r\n        return dialog;\r\n    }) : window.Dialog = dialog;\r\n    \r\n})()"],"sourceRoot":"/source/"}