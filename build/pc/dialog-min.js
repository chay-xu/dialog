!function(){function t(t){var o,a=this;o=$.extend(!0,{},l,t);var s=o.drag;a.css=o.css,a.options=o,a.type=o.type,a.$parent="string"==typeof o.container?$(o.container):o.container,0==this.$parent.length&&(a.$parent=$("body")),a.$el=$(e),a.$el.addClass(o.className),a._isBody="BODY"==this.$parent[0].nodeName,(o.fixed&&!a._isBody||"msg"==a.type)&&(a.options.isMove=!1),a._cid=i++,a._zIndex=n++,a.$elArr=[],o.beforeFn.apply(this),a.init(s),r.push(this),o.afterFn.apply(this),t=null}var e,i=1,n=99999900,r=[],o=!-[1],a=o&&!window.XMLHttpRequest,s=$(document),c=$(window),l={className:"",container:"body",css:{padding:"10px"},html:"加载中...",value:"",title:"信息",left:"50%",top:"50%",src:"about:blank",scrolling:"auto",align:"center",animate:!1,animateAlign:"bottom",winBtn:!0,buttons:[{name:"确定",callback:function(){},disabled:!1,focus:!1}],closeBtn:function(){},beforeFn:function(){},onloadFn:function(){},afterFn:function(){},shade:!0,shadeClose:!1,unload:!0,delay:!1,opacity:.5,fixed:!1,isMove:!0,resize:!0,drag:{limit:!0,range:[0,9999,9999,0],lockX:!1,lockY:!1,onStart:function(){},onMove:function(){},onEnd:function(){}}};e='<table class="xcy-table xcy-warpper"><tbody><tr><td class="xcy-tl xcy-resize-item" id="xcy-resize-tl"></td><td class="xcy-tc xcy-resize-item" id="xcy-resize-tc"></td><td class="xcy-tr xcy-resize-item" id="xcy-resize-tr"></td></tr><tr><td class="xcy-cl xcy-resize-item" id="xcy-resize-cl"></td><td class="xcy-cc"><div class="xcy-layer"></div></td><td class="xcy-cr xcy-resize-item" id="xcy-resize-cr"></td></tr><tr><td class="xcy-bl xcy-resize-item" id="xcy-resize-bl"></td><td class="xcy-bc xcy-resize-item" id="xcy-resize-bc"></td><td class="xcy-br xcy-resize-item" id="xcy-resize-br"></td></tr></tbody></table>';var d={sort:function(t){var e,i,n,o=r.length;for(e=0;o>e;e++)if(r[e]._cid==t){if(e==o-1){if(!i)return;return void $.each(r,function(t,e){e.$el.css("zIndex",e._zIndex),e.$proxy.css("zIndex",e._zIndex),e.$shade&&e.$shade.css("zIndex",e._zIndex)})}i=r[e],n=r[e+1]._zIndex,r[e]=r[e+1],r[e+1]=i,r[e]._zIndex=r[e+1]._zIndex,r[e+1]._zIndex=n}},toNumber:function(t,e){if(!t&&0!==t||"number"==typeof t)return t;var i=t.length-1;return t.lastIndexOf("px")===i-1?t=parseInt(t):t.lastIndexOf("%")===i&&(e||(e=100),t=parseInt(e*t.split("%")[0]/100)),t},debounce:function(t,e,i){if("function"==typeof t){e=e||150,i=i||null;var n,r=function(){t.apply(i)};return function(){window.clearTimeout(n),n=window.setTimeout(r,e)}}}};t.prototype={v:"2.0.5",constructor:t,init:function(t){var e,i=this,n=i.options,r=n.title,o=n.html,s="shade"==i.type||n.shade,l=i.$el,h=n.resize;switch(s&&(e="shade-layer-"+i._cid,i.$elArr.push("#"+e),i._shadeHtml(e),n.shadeClose&&i._bindShadeClose()),i.type){case"load":e="load-layer-"+i._cid,i._layerHtml(!1,o,!1);break;case"confirm":e="confirm-layer-"+i._cid,i._layerHtml(r,o,n.buttons);break;case"prompt":e="prompt-layer-"+i._cid,i._layerHtml(r,o,n.buttons);break;case"alert":e="alert-layer-"+i._cid,i._layerHtml(r,o,n.buttons);break;case"msg":e="msg-layer-"+i._cid,i._layerHtml(r,o,!1);break;case"iframe":e="iframe-layer-"+i._cid,i._layerHtml(r,!0,!1);break;default:e="page-layer-"+i._cid,i._layerHtml(r,o,!1)}if(i.$elArr.push("#"+e),l.attr("id",e),i.$proxy=$('<div class="xcy-proxy xcy-proxy-hidden"><div class="xcy-title xcy-drag"><span>'+r+"</span></div></div>").css({width:i.warpperWidth,height:i.warpperHeight,top:i.top,left:i.left,zIndex:i._zIndex}),i.$parent.append(i.$proxy),n.fixed&&(i._isBody?a?(i._ie6Fix=i._topFixed(c),c.bind("scroll",i._ie6Fix)):(i.$el.addClass("xcy-fixed"),i.$proxy.css("position","fixed")):(i._ie6Fix=i._topFixed(i.$parent),i.$parent.bind("scroll",i._ie6Fix))),a&&i._ie6SelectFix(),!h||!n.fixed&&n.isMove||(i._winResize=function(){n.isMove&&i._dragObj._size();var t=i.parentHeight-i.warpperHeight,e=i.parentWidth-i.warpperWidth,r=Number(i.top)/t,o=Number(i.left)/e;d.debounce(function(){i._getParentSize();var t=i.parentHeight-i.warpperHeight,e=i.parentWidth-i.warpperWidth,n=Math.round(r*t),a=Math.round(o*e);i.$el.css(i._setCss(n,a)),i.$proxy&&i.$proxy.css({top:n,left:a}),s&&i._shadeCss($(i.$elArr[0]))})()},i._isBody&&c.bind("resize",i._winResize)),i._restore={top:i.top,left:i.left,height:i.height,width:i.width},n.isMove){$.extend(t,{selector:i.$proxy,container:n.container,fixed:n.fixed,target:$(".xcy-title",l),isBody:i._isBody}),t.onStart=function(t){l.hide()};var u=t.onMove;t.onMove=function(t,e){i.top=t,i.left=e,u(t,e)},t.onEnd=function(t,e){i.$el.css({top:t,left:e}),i._restore.top=t,i._restore.left=e,l.show()},i._dragObj=new p(t)}if(l.bind("mousedown",function(){d.sort(e.split("-")[2])}),i.$iframe){var f=i.$iframe[0];f.attachEvent?f.attachEvent("onload",function(){n.onloadFn&&n.onloadFn(),f.detachEvent("onload",arguments.caller)}):f.onload=function(){n.onloadFn&&n.onloadFn(),f.onload=null}}n.delay&&(i.timer=setTimeout(function(){i._autoClose()},"boolean"==typeof n.delay?1800:n.delay))},_autoClose:function(){var t=this,e=t.$elArr.length-1;t.closed=!0,$.each(t.$elArr,function(i,n){$(n).animate({opacity:"0"},800,function(){i==e&&t.close()})})},_bindShadeClose:function(t){var e=this,i=$(".xcy-shade",e.$parent);i&&i.bind("click",function(t){e.closed||e.close()})},_getContent:function(){return $(".xcy-content",this.$el)},_getTitle:function(){return $(".xcy-title",this.$el)},_getFoot:function(){return $(".xcy-foot",this.$el)},_layerHtml:function(t,e,i){var n,r,o,a,s,c,l=this,p=l.options,h=l.type,u=l.$el,f=l.css,m=t!==!1;p.title=t,l._getParentSize(),m&&(n=l._titHtml(t),$(".xcy-layer",u).append(n)),"load"==h?r=l._loadHtml(e):"iframe"==h?r=l._iframeHtml(p.src):("prompt"==h?(r=l._conHtml('<div class="xcy-text"></div><input class="xcy-input" type="text" value="'+p.value+'" />'),r.find(".xcy-text").html(e)):r=l._conHtml(e),$(".xcy-main",r).css(f)),$(".xcy-layer",u).append(r),l.$parent.append(u),i&&(o=l._btnHtml(i),$(".xcy-layer",u).append(o)),"load"!==h&&p.closeBtn&&(a=l._winBtnHtml(h),$(".xcy-layer",u).append(a)),l._toNumberW(p.width),l._toNumberH(p.height),l._setCssSize(l._getContent()),l._getWarpperSize(u),p.animate?(s={},c=p.animateAlign,"bottom"==c?s={top:l.parentHeight+l.warpperHeight,left:d.toNumber(p.left,l.parentWidth-l.warpperWidth)}:"top"==c?s={top:-l.parentHeight,left:d.toNumber(p.left,l.parentWidth-l.warpperWidth)}:"left"==c?s={top:d.toNumber(p.top,l.parentHeight-l.warpperHeight),left:-l.warpperWidth}:"right"==c&&(s={top:d.toNumber(p.top,l.parentHeight-l.warpperHeight),left:l.parentWidth+l.warpperWidth}),u.css(s),u.animate(l._setCss(p.top,p.left),p.delay)):u.css(l._setCss(p.top,p.left),p.delay);try{i&&l.$focus.focus()}catch(x){}},_shadeHtml:function(t){var e=this,i=$('<div class="xcy-shade" id="'+t+'"></div>');e._shadeCss(i),e.$shade=i,e.$parent.append(i)},_shadeCss:function(t){var e=this,i=e.options.opacity,n=e._isBody,r=n?$("body").outerWidth():e.$parent[0].scrollWidth,o=n?s.innerHeight():e.$parent[0].scrollHeight;t.css({width:r,height:o,opacity:i,"z-index":e._zIndex})},_loadHtml:function(t){var e=this,i=e.options,n=$('<div class="xcy-load"><span class="xcy-load-img"></span><span>'+t+"</span></div>");return e._toNumberW(i.width),e._toNumberH(i.height),e._setCssSize(n),n},_iframeHtml:function(t){var e=this,i=e.options,n=$('<iframe allowtransparency="true" frameborder="0" class="xcy-iframe" name="xcy-iframe-'+e._cid+'"  src="'+t+'" scrolling="'+i.scrolling+'"></iframe>');return e.$iframe=n,e._conHtml("").html(n)},_conHtml:function(t){var e,i,n,r,o=this,a=o.options,s=$('<div class="xcy-content"><div class="xcy-main"></div></div>');return t&&1===t.nodeType&&(e=t.style.display,i=t.previousSibling,n=t.nextSibling,r=t.parentNode,o._elemBack=function(){i&&i.parentNode?i.parentNode.insertBefore(t,i.nextSibling):n&&n.parentNode?n.parentNode.insertBefore(t,n):r&&r.appendChild(t),t.style.display=e,o._elemBack=null}),s.find(".xcy-main").html(t),a.icon&&(s.addClass("xcy-icon-box"),s.append('<div class="xcy-icon-default xcy-icon-'+a.icon+'"></div>')),s},_titHtml:function(t){var e=$('<div class="xcy-title"></div>');return e.append('<span title="'+t+'">'+t+"</span>"),e},_btnHtml:function(t){var e=this,i=$('<div class="xcy-foot"></div>'),n="",r=t.length-1;return $.each(t,function(t,e){var i=e.disabled?"disabled":"",o="";o=0===t?"xcy-btn-r":t==r?"xcy-btn-l":"xcy-btn-m",n+='<button class="xcy-btn '+o+'" type="button" '+i+">"+e.name+"</button>"}),i.html(n),i.css("text-align",e.options.align),$("button",i).each(function(i){var n,r,o,a=$(this),s=t[i];a.click(function(t){r=s.callback,o=$(".xcy-input",e._getContent()).val(),r&&(n=r(a.text(),o)),n!==!1&&e.close()}),s.focus&&!s.disabled&&(e.$focus=a)}),i},_winBtnHtml:function(t){var e=this,i=e.options,n=i.closeBtn,r=i.winBtn,o=$('<div class="xcy-winBtn"></div>'),a="xcy-close-btn";return"iframe"==t&&r&&(o.append('<a class="xcy-winBtn-btn" id="xcy-min-btn" href="javascript:;">-</a>'),o.append('<a class="xcy-winBtn-btn" id="xcy-full-btn" href="javascript:;">+</a>')),("msg"==t&&i.title===!1||"page"==t&&i.title===!1)&&(a="xcy-x-btn"),o.append('<a class="xcy-winBtn-btn"  id="'+a+'" href="javascript:;">×</a>'),$("a",o).bind("click",function(t){var i=$(this).attr("id"),r=!0;switch(i){case"xcy-close-btn":case"xcy-x-btn":if(n&&(r=n(e.title())),r===!1)return;e.close();break;case"xcy-full-btn":e.full(),$(this).attr("id","xcy-restore-btn"),$("#xcy-min-btn",e.$el).show();break;case"xcy-restore-btn":e.restore(),$(this).attr("id","xcy-full-btn"),$("#xcy-min-btn",e.$el).show();break;case"xcy-min-btn":$(this).hide(),e.min(),$(this).next().attr("id","xcy-restore-btn")}}),o},_topFixed:function(t){var e,i=this;return e=function(){d.debounce(function(){i.$el.css({top:i.top+t.scrollTop(),left:i.left+t.scrollLeft()})})()}},_ie6SelectFix:function(){var t,e=this,i=e.$el,n=e.warpperWidth,r=e.warpperHeight;t=document.createElement("iframe"),t.src="about:blank;",t.style.cssText="position:absolute;z-index:-1;left:0;top:0;filter:alpha(opacity=0);border:0 none;width:"+n+"px;height:"+r+"px;",i.append(t)},_toNumberW:function(t){var e,i,n=this;n._getWarpperSize(n.$el),n._getConWidth(),t&&(-1!==String(t).indexOf("%")&&(e=n.width,i=n.warpperWidth-e,t=d.toNumber(t,n.parentWidth-i)),n.width=Number(t))},_toNumberH:function(t){var e,i,n=this;n._getWarpperSize(n.$el),n._getConHeight(),t&&(-1!==String(t).indexOf("%")&&(e=n.height,i=n.warpperHeight-e,t=d.toNumber(t,n.parentHeight-i)),n.height=Number(t))},_setCssSize:function(t){var e=this;e.css;t.css({width:e.width,height:e.height})},_setCss:function(t,e){var i=this,n=i.options,r=(i.$parent,i._isBody),o=0,c=0,l={};return n.fixed&&a&&(o=r?s.scrollTop():i.$parent.scrollTop(),c=r?s.scrollLeft():i.$parent.scrollLeft()),(void 0===t||""===t)&&(t="50%"),t=d.toNumber(t,i.parentHeight-i.warpperHeight),i.top=t,(void 0===e||""===e)&&(e="50%"),e=d.toNumber(e,i.parentWidth-i.warpperWidth),i.left=e,l["z-index"]=i._zIndex,l.top=t+o,l.left=e+c,l},_getConWidth:function(){var t=this;t.width=t._getContent().width()},_getConHeight:function(){var t=this;t.height=t._getContent().height()},_getParentSize:function(){var t=this,e=(t.options,t.$parent),i=t._isBody;t.parentWidth=i?c.innerWidth():e[0].clientWidth,t.parentHeight=i?c.innerHeight():e[0].clientHeight},_getWarpperSize:function(t){this.warpperWidth=t.outerWidth(),this.warpperHeight=t.outerHeight()},min:function(){this.resize("180","0",this.top,this.left)},full:function(){this.resize("100%","100%",0,0)},restore:function(){var t=this,e=t._restore;t.resize(e.width,e.height,e.top,e.left)},title:function(t){var e=this._getTitle().children("span"),i=t?e.html(t):e.html();return t?this:i},html:function(t){return this._getContent().html(t),this},buttons:function(t){return $("button",this.$el).unbind("click"),this._getFoot().replaceWith(this._btnHtml(t)),this},resize:function(t,e,i,n,r){var o,a,s,c,l,d=this;parseInt(d.$el.css("left")),parseInt(d.$el.css("top"));return d._toNumberW(t),d._toNumberH(e),o=d.width,a=d.height,this.options.height=e,this.options.width=t,d._setCssSize(d._getContent()),d._getWarpperSize(d.$el),l=d._setCss(i,n),c=l.top,s=l.left,d.$proxy.css({left:s,top:c,width:d.warpperWidth,height:d.warpperHeight}),console.log(c,s,d.warpperHeight,d.warpperWidth),d.$el.css({top:c,left:s}),this},moveTo:function(t,e){var i=this;return t=d.toNumber(t,i.parentHeight),e=d.toNumber(e,i.parentWidth),this._dragObj?box=i._dragObj.range(t,e,i.warpperWidth,i.warpperHeight):box=i._setCss(t,e),i.$el.css(i._setCss(box.top,box.left)),this},setDrag:function(t){return this._dragObj?(this._dragObj.set(t),this):this},hide:function(){return $.each(this.$elArr,function(t,e){$(e).hide()}),this},show:function(){return $.each(this.$elArr,function(t,e){$(e).show()}),this},close:function(){var t=this;return t.timer&&(clearTimeout(t.timer),t.timer=null),t.closed=null,t.options.unload?void t.unload():void t.hide()},unload:function(){var t,e=this;if($("button",e.$el).unbind("click"),$(".xcy-winBtn a",e.$el).unbind("click"),e.$el.unbind("mousedown"),e._winResize&&c.unbind("resize",e._winResize),e._ie6Fix&&(c.unbind("scroll",e._ie6Fix),e.$parent.unbind("scroll",e._ie6Fix)),e.options.shadeClose&&$(".xcy-shade",e.$parent).unbind("click"),e.options.isMove&&e._dragObj.disable(),e._elemBack&&e._elemBack(),"iframe"===e.type)try{var i=e.$iframe[0];i.contentWindow.document.write(""),i.contentWindow.close(),e.$iframe.remove()}catch(n){}for($.each(e.$elArr,function(t,e){$(e).remove()}),e.$elArr=null,e.$proxy.remove(),e.$proxy=null,t=r.length;t--;)r[t]._cid===this._cid&&r.splice(t,1)},closeAll:function(){$.each(r,function(t,e){e.close()})}};var p=function(t){function e(t){function e(t){var e,n=t.type,r=$(t.target);i.$target.attr("class");switch(e=0!==r.parents(".xcy-drag").length?r.parents(".xcy-drag"):r,n){case"mousedown":i.options.onStart(i.$drag),e.hasClass("xcy-drag")&&(i.$drag.removeClass("xcy-proxy-hidden"),i.diffx=t.clientX-i.$drag[0].offsetLeft,i.diffy=t.clientY-i.$drag[0].offsetTop,i._getOffSize(),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),o?(i.$drag.bind("losecapture",i._end),i.$drag[0].setCapture()):s.bind("blur",i._end),s.bind("mousemove",i._handleEvent),s.bind("mouseup",i._handleEvent),t.preventDefault());break;case"mousemove":var a=t.clientX-i.diffx,c=t.clientY-i.diffy;i._move(c,a,i.dragH,i.dragW),t.preventDefault();break;case"mouseup":i.$drag.addClass("xcy-proxy-hidden"),i._end()}}var i=this;i.diffx=0,i.diffy=0,i.options=t,i.$drag="string"==typeof t.selector?$(t.selector):t.selector,i.$target="string"==typeof t.selector?$(t.target):t.target,i._handleEvent=e,i._init()}return e.prototype={_init:function(){var t=this;t._size(),t.$target.addClass("xcy-drag"),t.$target.bind("mousedown",t._handleEvent)},_getActive:function(){try{var t=document.activeElement,e=t.contentDocument,i=e&&e.activeElement||t;return i}catch(n){}},_size:function(){var t,e=this,i=e.options,n=i.range;i.limit&&(e.mxT=n[0],e.mxR=void 0!==n[1]?n[1]:n[0],e.mxB=void 0!==n[2]?n[2]:n[0],e.mxL=void 0!==n[3]?n[3]:n[1]?n[1]:n[0],e._getOffSize(),t=$(i.container),!i.fixed&&i.isBody?(e.h=s.outerHeight(),e.w=s.outerWidth()):i.fixed&&i.isBody?(e.h=c.innerHeight(),e.w=c.innerWidth()):(e.h=t[0].scrollHeight,e.w=t[0].scrollWidth),"relative"==t.css("position")&&t.css("position","relative"),i.lockX&&(e.mxR=e.mxL=e.left),i.lockY&&(e.mxT=e.mxB=e.top))},_getOffSize:function(){var t=this;t.dragW=t.$drag.outerWidth(),t.dragH=t.$drag.outerHeight(),t.left=parseInt(t.$drag.css("left")),t.top=parseInt(t.$drag.css("top")),t.mxR=Math.max(t.mxR,t.mxL+t.dragW),t.mxB=Math.max(t.mxB,t.mxT+t.dragH)},_move:function(t,e,i,n){var r,o,a,s=this;r=s.range(t,e,n,i),o=r.left,a=r.top,s.$drag.css({left:o,top:a}),s.left=o,s.top=a,s.options.onMove(a,o)},_end:function(){var t=this;s.unbind("mousemove",t._handleEvent),s.unbind("mouseup",t._handleEvent),o?(t.$drag.unbind("losecapture",t._end),t.$drag[0].releaseCapture()):s.unbind("blur",t._end),t.options.onEnd(t.top,t.left)},range:function(t,e,i,n){var r,o,a,s,c=this,l=c.options,d={};return l.limit&&(r=c.mxT,o=c.mxR,a=c.mxL,s=c.mxB,l.container&&(r=Math.max(c.mxT,0),o=Math.min(c.w-i,c.mxR-i),a=Math.max(c.mxL,0),s=Math.min(c.h-n,c.mxB-n)),e=Math.max(Math.min(e,o),a),t=Math.max(Math.min(t,s),r)),d.left=e,d.top=t,d.width=i,d.height=n,d},set:function(t){var e=this;t&&$.extend(e.options,t),e._size()},enable:function(){var t=this;t.$drag.bind("mousedown",t._handleEvent)},disable:function(){var t=this;t.$drag.unbind("mousedown",t._handleEvent)}},e}(),h={create:function(e){var i=new t(e);return i},load:function(t,e,i,n){return Dialog.create({type:"load",html:t,fixed:!0,unload:!0,shade:i||!1,shadeClose:n||!0,delay:"undefined"!=typeof e?e:!1})},prompt:function(t,e,i,n){return Dialog.create({type:"prompt",html:t,value:e,fixed:!0,width:300,unload:!0,shade:!0,buttons:[{name:"确定",callback:i,disabled:!1,focus:!0},{name:"取消",callback:n,disabled:!1,focus:!1}]})},confirm:function(t,e,i){return Dialog.create({type:"confirm",html:t,fixed:!0,unload:!0,shade:!0,buttons:[{name:"确定",callback:e,disabled:!1,focus:!0},{name:"取消",callback:i,disabled:!1,focus:!1}]})},alert:function(t,e,i){return"function"==typeof e&&(i=e,e={},e.title=l.title),Dialog.create({type:"alert",html:t,icon:e.icon||!1,fixed:!0,title:e.title,unload:!0,shade:e.shade===!1?!1:!0,buttons:[{name:"确定",callback:i,disabled:!1,focus:!0}]})},msg:function(t,e,i){return e="undefined"!=typeof e?e:!0,Dialog.create({type:"msg",title:!1,html:t,fixed:!0,unload:!0,shade:i||!1,closeBtn:e?!1:function(){},delay:e,isMove:!1})},config:function(t){return $.extend(l,t)}};"function"==typeof define?define(function(){return h}):window.Dialog=h}();
//# sourceMappingURL=../pc/dialog-min.js.map