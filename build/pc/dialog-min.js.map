{"version":3,"sources":["pc/dialog.js"],"names":["DialogLayer","options","opt","that","this","$","extend","Default","css","type","$parent","container","length","$el","dialogHtml","addClass","className","_isBody","nodeName","isMove","_cid","_zIndex","$elArr","beforeFn","apply","init","layers","push","afterFn","_isIE","_isIE6","window","XMLHttpRequest","$doc","document","$win","padding","html","value","title","left","top","src","scrolling","align","animate","animateAlign","winBtn","buttons","name","callback","disabled","focus","closeBtnFn","onloadFn","shade","shadeClose","unload","delay","opacity","fixed","resize","drag","limit","range","lockX","lockY","onStart","onMove","onEnd","support","sort","cid","j","len","each","i","obj","$proxy","$shade","toNumber","maxValue","last","lastIndexOf","parseInt","split","debounce","context","timeout","runIt","clearTimeout","setTimeout","prototype","v","constructor","_drag","id","borderWidth","showShade","_shadeHtml","_bindShadeClose","_layerHtml","attr","find","outerWidth","width","warpperWidth","height","warpperHeight","zIndex","append","_ie6Fix","_topFixed","bind","_ie6SelectFix","_winResize","_dragObj","_size","ph","parentHeight","pw","parentWidth","t","Number","l","_getParentSize","nph","npw","Math","round","_setCss","_shadeCss","_restore","_move","$iframe","iframe","attachEvent","detachEvent","arguments","caller","onload","timer","_autoClose","closed","close","parent","e","_getContent","_getTitle","_getFoot","content","buttonArr","tit","con","btn","animateCss","cssObj","isTitle","_titHtml","_loadHtml","_iframeHtml","_conHtml","_btnHtml","_winBtnHtml","_toNumberW","_toNumberH","_setCssSize","_getWarpperSize","$focus","el","isBody","scrollWidth","innerHeight","scrollHeight","z-index","node","display","prev","next","nodeType","style","previousSibling","nextSibling","parentNode","_elemBack","insertBefore","appendChild","icon","isReturn","val","$ele","click","text","opts","msgClass","full","show","restore","hide","min","selector","target","$drag","DragDrop","Fix","scrollTop","scrollLeft","createElement","cssText","w","conW","overW","_getConWidth","String","indexOf","h","conH","overH","_getConHeight","dt","dl","undefined","innerWidth","clientWidth","clientHeight","outerHeight","children","newTitle","unbind","replaceWith","isdrag","box","moveTo","setDrag","o","set","disable","contentWindow","write","remove","splice","closeAll","dragdrop","_handleEvent","$target","parents","hasClass","removeClass","diffx","clientX","offsetLeft","diffy","clientY","offsetTop","_getOffSize","getSelection","removeAllRanges","selection","empty","_end","setCapture","preventDefault","dragH","dragW","_init","_getActive","activeElement","contentDocument","elem","$container","mxT","mxR","mxB","mxL","max","position","releaseCapture","enable","dialog","create","load","msg","Dialog","prompt","ok","cancel","confirm","alert","config","define"],"mappings":"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","file":"pc/dialog-min.js","sourcesContent":["/**\r\n * @file dialog plugin\r\n * @author xucaiyu\r\n * @email 569455187@qq.com\r\n * @version 2.5.0\r\n * @date 2015-10-10\r\n * @license MIT License \r\n */\r\n \r\n/** \r\n  * {\r\n  *     type: {string}\r\n  *     contain: {string}\r\n  *     html: {string}\r\n  *     fun: {\r\n  *         ok: {function},\r\n  *         cancel: {function}\r\n  *     }   \r\n  * }\r\n  */\r\n  \r\n;!(function(){  \r\n// function Dialog( options ){\r\n    var _cid = 1,\r\n        _zIndex = 99999900,\r\n        _zIndexc = 999900,\r\n        layers = [],\r\n        _isIE = !-[1,],\r\n        _isIE6 = _isIE && !window.XMLHttpRequest,\r\n        $doc = $( document ),\r\n        $win = $( window ),\r\n        Default = {\r\n            className: '',\r\n            container: 'body',\r\n            // css: {},\r\n            css: { padding: '10px' },\r\n            html: '加载中...',\r\n            value: '',\r\n            title: '信息',\r\n            left: '50%',\r\n            top: '50%',\r\n            src: 'about:blank',\r\n            scrolling: 'auto',\r\n            align: 'center',\r\n            animate: false,\r\n            animateAlign: 'bottom',\r\n            winBtn: true,\r\n            buttons: [\r\n                {\r\n                    name: '确定',\r\n                    callback: function(){},\r\n                    disabled: false,\r\n                    focus: false\r\n                }\r\n                // ,\r\n                // {\r\n                //     name: '取消',\r\n                //     callback: function(){},\r\n                //     disabled: false,\r\n                //     focus: false\r\n                // }\r\n            ],\r\n            closeBtnFn: function(){},         // 关闭图层执行\r\n            beforeFn: function(){},         // 初始化之前执行函数\r\n            onloadFn: function(){},         // iframe 页面加载完成执行\r\n            afterFn: function(){},          // 初始化之后执行函数\r\n            shade: true,\r\n            shadeClose: false,\r\n            unload: true,\r\n            delay: false,\r\n            opacity: 0.5,\r\n            fixed: false,\r\n            isMove: true,\r\n            resize: true,\r\n            drag: {\r\n                limit: false,\r\n                range: [ 0, 9999, 9999, 0 ],\r\n                // client: false,\r\n                lockX: false,\r\n                lockY: false,\r\n                onStart: function(){},\r\n                onMove: function(){},\r\n                onEnd: function(){}\r\n            }\r\n        },\r\n        dialogHtml;\r\n\r\n    dialogHtml = ''\r\n    // +'<div class=\"xcy-warpper\">'\r\n    +    '<table class=\"xcy-table xcy-warpper\">'\r\n    +        '<tbody>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-tl xcy-resize-item\" id=\"xcy-resize-tl\"></td>'\r\n    +                '<td class=\"xcy-tc xcy-resize-item\" id=\"xcy-resize-tc\"></td>'\r\n    +                '<td class=\"xcy-tr xcy-resize-item\" id=\"xcy-resize-tr\"></td>'\r\n    +            '</tr>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-cl xcy-resize-item\" id=\"xcy-resize-cl\"></td>'\r\n    +                '<td class=\"xcy-cc\">'\r\n    +                    '<div class=\"xcy-layer\">'\r\n    +                    '</div>'\r\n    +                '</td>'\r\n    +                '<td class=\"xcy-cr xcy-resize-item\" id=\"xcy-resize-cr\"></td>'\r\n    +            '</tr>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-bl xcy-resize-item\" id=\"xcy-resize-bl\"></td>'\r\n    +                '<td class=\"xcy-bc xcy-resize-item\" id=\"xcy-resize-bc\"></td>'\r\n    +                '<td class=\"xcy-br xcy-resize-item\" id=\"xcy-resize-br\"></td>'\r\n    +            '</tr>'\r\n    +        '</tbody>'\r\n    +    '</table>';\r\n    // +'</div>';\r\n\r\n    // support unit\r\n    var support = {\r\n        /**\r\n         * layers 层级冒泡 将被点击层提升z-index最高\r\n         * @param {string|number} dialog对象_cid\r\n         */\r\n        sort: function( cid ){\r\n            var len = layers.length,\r\n                j, _cid, _zIndex;\r\n\r\n            for( j = 0; j < len; j++ ){\r\n                // bubble key position\r\n                if( layers[ j ]._cid == cid ){\r\n                    // 如果是最后1位开始重新渲染\r\n                    if( j == len - 1 ){\r\n                        // if no change 如果原始位置就在最后1位立即返回\r\n                        if( !_cid ) return;\r\n                        // change z-inde style\r\n                        $.each( layers, function( i, obj ){\r\n                            obj.$el.css( 'zIndex', obj._zIndex );\r\n                            obj.$proxy.css( 'zIndex', obj._zIndex );\r\n                            obj.$shade && obj.$shade.css( 'zIndex', obj._zIndex );\r\n                        });\r\n\r\n                        return;\r\n                    }\r\n\r\n                    // bubble\r\n                    _cid = layers[ j ];\r\n                    _zIndex = layers[ j+1 ]._zIndex;\r\n\r\n                    layers[ j ] = layers[ j+1 ];\r\n                    layers[ j+1 ] = _cid;\r\n\r\n                    layers[ j ]._zIndex = layers[ j+1 ]._zIndex;\r\n                    layers[ j+1 ]._zIndex = _zIndex;\r\n\r\n                }\r\n                \r\n            }\r\n        },\r\n        /**\r\n         * px and % to value of number\r\n         * @param {string|number} value 转换值\r\n         * @param {string|number} max value 最大值\r\n         * @return {number}\r\n         */\r\n        toNumber: function( value, maxValue ){\r\n            if (!value && value !== 0 || typeof value === 'number') {\r\n                return value;\r\n            }\r\n\r\n            var last = value.length - 1;\r\n            if ( value.lastIndexOf('px') === last - 1 ) {\r\n                value = parseInt(value);\r\n            } else if ( value.lastIndexOf('%') === last ) {\r\n                if( !maxValue ) maxValue = 100;\r\n                value = parseInt( maxValue * value.split('%')[0] / 100 );\r\n            }\r\n\r\n            return value;\r\n        },\r\n        /** \r\n         * window resize ie6~7 bug\r\n         * @param {Function} callback 回调函数 \r\n         * @param {Integer} delay   延迟时间，单位为毫秒(ms)，默认150 \r\n         * @param {Object} context  上下文，即this关键字指向的对象，默认为null \r\n         * @return {Function} \r\n         */ \r\n        debounce: function( callback, delay, context ){\r\n            if (typeof(callback) !== \"function\") {  \r\n                return;  \r\n            }\r\n\r\n            delay = delay || 150;\r\n            context = context || null;\r\n            var timeout,\r\n                runIt = function(){\r\n                    callback.apply(context);  \r\n                };  \r\n            return (function(){\r\n                window.clearTimeout(timeout);  \r\n                timeout = window.setTimeout(runIt, delay);  \r\n            });  \r\n        }    \r\n    };\r\n\r\n    function DialogLayer( options ){\r\n        var that = this,\r\n            $el, opt;\r\n\r\n        /**\r\n         * mix param\r\n         * drag css dialog\r\n         */\r\n        \r\n        // // drag\r\n        // var _drag = $.extend( {}, Default.drag, options.drag );\r\n        // // css\r\n        // that.css = $.extend( {}, Default.css, options.css );\r\n        // dialog\r\n        opt = $.extend( true, {}, Default, options );\r\n        that.css = opt.css;\r\n\r\n        that.options = opt;\r\n        that.type = opt.type;\r\n\r\n        // dialog parent\r\n        // that.$parent = $( opt.fixed ? 'body' : opt.container );\r\n        \r\n        that.$parent = (typeof opt.container === 'string') ? $( opt.container ) : opt.container;\r\n        if( this.$parent.length == 0 ) that.$parent = $('body');\r\n        // dialog warpper\r\n        that.$el =  $( dialogHtml );\r\n        that.$el.addClass( opt.className );\r\n\r\n        // fixed or limit choose\r\n        that._isBody = (this.$parent[0].nodeName == 'BODY');\r\n        // 悬浮就不能拖动\r\n        // if( (opt.fixed && !that._isBody) || that.type == 'msg' ) \r\n        if( (opt.fixed) || that.type == 'msg' ) \r\n            that.options.isMove = false;\r\n\r\n        // private\r\n        that._cid = _cid++;\r\n        that._zIndex = _zIndex++;\r\n\r\n        // type layer id array\r\n        that.$elArr = [];\r\n        // init function 初始化之前执行的自定义函数\r\n        opt.beforeFn.apply( this );\r\n\r\n        that.init();\r\n        // save global dialog\r\n        layers.push( this );\r\n\r\n        // init function 初始化之后执行的自定义函数\r\n        opt.afterFn.apply( this );\r\n        options = null;\r\n    }\r\n    // dialog\r\n    DialogLayer.prototype = {\r\n        v: '2.0.5',\r\n        constructor: DialogLayer,\r\n        init: function( _drag ){\r\n            var that = this,\r\n                opt = that.options,\r\n                title = opt.title,\r\n                html = opt.html,\r\n                showShade = that.type == 'shade' || opt.shade,\r\n                $el = that.$el,\r\n                resize = opt.resize,\r\n                $tit, id, borderWidth;\r\n\r\n            // shade layer\r\n            if( showShade ){\r\n                id = 'shade-layer-'+ that._cid;\r\n\r\n                that.$elArr.push( '#'+id );\r\n\r\n                // that.shadeEvent( that.parent, id );\r\n                that._shadeHtml( id );\r\n                opt.shadeClose && that._bindShadeClose();\r\n            }\r\n            switch( that.type ){\r\n                case 'load':\r\n                    id = 'load-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( false, html, false );\r\n                    break;\r\n                case 'confirm':\r\n                    id = 'confirm-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'prompt':\r\n                    id = 'prompt-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'alert':\r\n                    id = 'alert-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'msg':\r\n                    id = 'msg-layer-'+ that._cid;\r\n                \r\n                    that._layerHtml( title, html, false );\r\n                    break;\r\n                case 'iframe':\r\n                    id = 'iframe-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, true, false );\r\n                    break;\r\n                default:\r\n                    id = 'page-layer-'+ that._cid;\r\n                \r\n                    that._layerHtml( title, html, false );\r\n            }\r\n            // push id\r\n            that.$elArr.push( '#'+id );\r\n\r\n            // set id\r\n            $el.attr( 'id', id );\r\n\r\n            // append drag proxy\r\n            borderWidth = $el.find('.xcy-cl').outerWidth(true) * 2;\r\n\r\n            that.$proxy = $('<div class=\"xcy-proxy xcy-proxy-hidden\"><div class=\"xcy-title xcy-drag\"><span>'+title+'</span></div></div>').css({\r\n                width: that.warpperWidth - borderWidth,\r\n                height: that.warpperHeight - borderWidth,\r\n                top: that.top,\r\n                left: that.left,\r\n                zIndex: that._zIndex\r\n            })\r\n            that.$parent.append( that.$proxy );\r\n\r\n            // container is body\r\n            // if( that.$parent[0].nodeName == 'BODY' ){\r\n                // fixed position\r\n                // layer滚动\r\n                if( opt.fixed ){\r\n                    // parent is body\r\n                    if( that._isBody ){\r\n                        \r\n                        // ie6的固定与相对定位 fixed\r\n                        if( _isIE6 ){\r\n                            that._ie6Fix = that._topFixed( $win );\r\n                            $win.bind( 'scroll', that._ie6Fix );\r\n                        }else{\r\n                            that.$el.addClass( 'xcy-fixed' );\r\n                            // that.$proxy.addClass( 'xcy-fixed' );\r\n                            \r\n                            // $win.bind( 'scroll', function(){\r\n                            //     console.log(that.top + $doc.scrollTop())\r\n                            //     that.$proxy.css({\r\n                            //         top: that.top + $doc.scrollTop(),\r\n                            //         left: that.left + $doc.scrollLeft()\r\n                            //     })\r\n                            // } );\r\n                        }\r\n\r\n                    // parent is not body\r\n                    }else{\r\n                        // container fixed\r\n                        that._ie6Fix = that._topFixed( that.$parent );\r\n                        // scroll event\r\n                        that.$parent.bind( 'scroll', that._ie6Fix );\r\n                    }\r\n                }\r\n                // set shade layer the height\r\n                // $( '#shade-layer-' + that._cid ).css( 'height', that.$parent[0].scrollHeight );\r\n            // }\r\n\r\n            // ie6 bug\r\n            if( _isIE6 ){\r\n                // iframe mask ie6 select tag bug\r\n                that._ie6SelectFix();\r\n            }\r\n\r\n            // fixed and no move bind resize event of dialog\r\n            // 窗口大小改变事件\r\n            if( resize && (opt.fixed || !opt.isMove) ){\r\n                that._winResize = function(){\r\n\r\n                    opt.isMove && that._dragObj._size();\r\n                    // 获取layer位置\r\n                    var ph = that.parentHeight - that.warpperHeight,\r\n                        pw = that.parentWidth - that.warpperWidth,\r\n                        t = Number(that.top)/ph,\r\n                        l = Number(that.left)/pw;\r\n\r\n                    // debounce 防止resize执行过于频繁\r\n                    support.debounce( function(){\r\n                        \r\n                        that._getParentSize();\r\n                        // 刷新窗口重新计算layer位置\r\n                        var nph = that.parentHeight - that.warpperHeight,\r\n                            npw = that.parentWidth - that.warpperWidth,\r\n                            top = Math.round( t*nph ),\r\n                            left = Math.round( l*npw );\r\n\r\n                        // set layer css\r\n                        that.$el.css( that._setCss( top, left ) );\r\n                        // set proxy css\r\n                        that.$proxy && that.$proxy.css({\r\n                                top:  top,\r\n                                left: left \r\n                            })\r\n                        // set shade css\r\n                        if( showShade ){\r\n                            that._shadeCss( $( that.$elArr[0] ) );\r\n                        }\r\n                    })();\r\n                    // that.$parent.scroll();\r\n                };\r\n\r\n                if( that._isBody ){\r\n                    $win.bind( 'resize', that._winResize );\r\n                }else{\r\n                    // this.$parent.bind( 'resize', that._winResize );\r\n                }\r\n            }\r\n\r\n            // restore 记住原始大小和位置\r\n            that._restore = {top: that.top, left: that.left, height: that.height, width: that.width };\r\n\r\n            // drag layer move\r\n            if( opt.isMove ){\r\n                \r\n                // var timeStep;          \r\n                that._move();\r\n            }\r\n            // 层级冒泡排序\r\n            $el.bind('mousedown', function(){\r\n                // bubble z-index, set drag ladyer z-index\r\n                support.sort( id.split( '-' )[2] );\r\n            })\r\n            \r\n            // 监控加载状态\r\n            if( that.$iframe ){\r\n                var iframe = that.$iframe[0];\r\n                if( iframe.attachEvent ){\r\n                    iframe.attachEvent( \"onload\", function(){\r\n                        opt.onloadFn && opt.onloadFn();\r\n                        iframe.detachEvent( \"onload\", arguments.caller);\r\n                    });\r\n                }else{\r\n                    iframe.onload = function(){\r\n                        opt.onloadFn && opt.onloadFn();\r\n                        iframe.onload = null;\r\n                    };\r\n                }\r\n            }\r\n\r\n            // auto hidden\r\n            if( opt.delay )\r\n                that.timer = setTimeout( function(){ that._autoClose(); }, typeof opt.delay === 'boolean' ? 1800 : opt.delay );\r\n\r\n            // resize\r\n//             $el.addClass('xcy-resize');\r\n//             $el.delegate('.xcy-resize-item', 'mousedown', function(){\r\n//                 var $me = $(this),\r\n//                     id = $me.attr('id'),\r\n//                     // h = $win.innerHeight(),\r\n//                     // w = $win.innerWidth();\r\n//                     parentOffset = that.$parent.offset(),\r\n//                     parentTop = parentOffset.top,\r\n//                     parentLeft = parentOffset.left;\r\n//                     // oldLeft = that.left;\r\n//                     that.$proxy.css({\r\n//                         top: that.top,\r\n//                         left: that.left\r\n//                     })\r\n\r\n//                 var offset = that.$proxy.offset(),\r\n//                     top = offset.top,\r\n//                     left = offset.left,\r\n//                     width = that.$proxy.width(),\r\n//                     height = that.$proxy.height();\r\n\r\n//                     // $(document).bind( 'mousemove', handleResize );\r\n//                     // $(document).bind( 'mouseup', unResize)\r\n                    \r\n//                     function handleResize( e ){\r\n//                         var type = e.type;\r\n\r\n//                         // var offset = $proxy.offset(),\r\n//                         //     top = offset.top,\r\n//                         //     left = offset.left;\r\n\r\n//                         // window capture focus\r\n//                         if( _isIE ){\r\n//                             $me.bind( 'losecapture', that._end );\r\n//                             $me[0].setCapture();\r\n//                         }else{\r\n//                             $doc.bind( 'blur', that._end );\r\n//                         }\r\n\r\n//                         // clear selected text\r\n//                         window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\r\n\r\n//                         switch(id){\r\n//                             case 'xcy-resize-tl':\r\n//                                 break;\r\n//                             case 'xcy-resize-tc':\r\n//                                 break;\r\n//                             case 'xcy-resize-tr':\r\n//                                 break;\r\n//                             case 'xcy-resize-cl':\r\n//                                 // console.log(left, oldLeft);\r\n//                                 if(e.clientX < parentLeft) return;\r\n//                                 if(e.clientX > left+width-150) return;\r\n// console.log(left );\r\n//                                 // var cssPosition = that._dragObj.range(top, e.clientX - parentLeft, width + (left - e.clientX), height) \r\n//                                 that.$proxy.css({\r\n//                                     display: 'block',\r\n//                                     left: cssPosition.left,\r\n//                                     width: cssPosition.width\r\n//                                 })\r\n//                                 // that.resize( (that.width + that.left - e.clientX)+left, that.height, that.top, e.clientX-left)\r\n//                                 break;\r\n//                             case 'xcy-resize-cr':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                             case 'xcy-resize-bl':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                             case 'xcy-resize-bc':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                             case 'xcy-resize-br':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                         }\r\n                        \r\n//                         // if(e.clientX <= 20) return;\r\n\r\n//                         // that.resize( (that.width + that.left - (e.clientX ))+20, that.height, that.top, e.clientX-20)\r\n//                         // console.log(that.left, e.clientX, that.$parent.offset().left)\r\n\r\n//                         return false;\r\n//                     }\r\n\r\n//                     function unResize(){\r\n//                         $(document).unbind( 'mousemove', handleResize );\r\n//                         $(document).unbind( 'mouseup', unResize );\r\n\r\n//                         var offset = that.$proxy.position();\r\n//                         console.log(offset.top, offset.left, '---++++---')\r\n\r\n//                         that.resize( that.$proxy.width(), that.$proxy.height(), offset.top, offset.left, true )\r\n//                         that.$proxy.hide();\r\n//                     }\r\n//             })\r\n\r\n        },\r\n        _autoClose: function(){\r\n            var that = this,\r\n                len = that.$elArr.length - 1;\r\n\r\n            that.closed = true;\r\n\r\n            $.each( that.$elArr, function( i, v ){\r\n                $( v ).animate({opacity: '0'}, 800, function(){ \r\n                    i == len && that.close(); \r\n                });\r\n            });\r\n        },\r\n        _bindShadeClose: function( parent ){\r\n            var that = this,\r\n                $el = $( '.xcy-shade', that.$parent );\r\n\r\n            $el && $el.bind( 'click', function( e ){\r\n                if( that.closed ) return;\r\n                that.close();\r\n            });\r\n        },\r\n        _getContent: function(){\r\n\r\n            return $( '.xcy-content', this.$el );\r\n        },\r\n        _getTitle: function(){\r\n\r\n            return $( '.xcy-title', this.$el );\r\n        },\r\n        _getFoot: function(){\r\n\r\n            return $( '.xcy-foot', this.$el );\r\n        },\r\n        // html render\r\n        _layerHtml: function( title, content, buttonArr ){\r\n            var that = this,\r\n                opt = that.options,\r\n                type = that.type,\r\n                $el = that.$el,\r\n                cssObj = that.css,\r\n                isTitle = title !== false,\r\n                tit, con, btn, winBtn,\r\n                animateCss, animateAlign;\r\n\r\n            opt.title = title;\r\n            // get parent size \r\n            that._getParentSize();\r\n            // title\r\n            if( isTitle ){\r\n                \r\n                tit = that._titHtml( title );\r\n                \r\n                // render title\r\n                $( '.xcy-layer', $el ).append( tit );\r\n            }\r\n\r\n            // content\r\n            if( type == 'load' ){\r\n\r\n                con = that._loadHtml( content );\r\n            }else if( type == 'iframe' ){\r\n                \r\n                con = that._iframeHtml( opt.src );           \r\n            }else{\r\n                if( type == 'prompt' ){\r\n                    con = that._conHtml( '<div class=\"xcy-text\">'\r\n                        + '</div><input class=\"xcy-input\" type=\"text\" value=\\\"' + opt.value + '\\\" />' );\r\n\r\n                    con.find( '.xcy-text' ).html( content );\r\n                }else{\r\n                    con = that._conHtml( content );\r\n                }\r\n\r\n                // 宽高设置xcy-main层\r\n                // 自定义css 设置在xyc-main-inner层\r\n                $( '.xcy-main', con ).css( cssObj ); \r\n            }\r\n\r\n            // render content\r\n            $( '.xcy-layer', $el ).append( con );\r\n\r\n            // append dialog\r\n            // 按钮要焦点 需要先渲染\r\n            that.$parent.append( $el );\r\n\r\n            // buttons element\r\n            if( buttonArr ){\r\n                btn = that._btnHtml( buttonArr );\r\n\r\n                // render buttons\r\n                $( '.xcy-layer', $el ).append( btn );\r\n            }\r\n\r\n            // window controll buttons\r\n            if( type !== 'load' && opt.closeBtnFn ){\r\n                winBtn = that._winBtnHtml( type );\r\n                // render window buttons\r\n                $( '.xcy-layer', $el ).append( winBtn );\r\n\r\n            }   \r\n            // 转换宽高为数字\r\n            that._toNumberW( opt.width );\r\n            that._toNumberH( opt.height );      \r\n\r\n            // set content css\r\n            that._setCssSize( that._getContent() );\r\n\r\n            // get warpper size\r\n            that._getWarpperSize( $el );\r\n\r\n            // set warpper css position\r\n            if( opt.animate ){\r\n                animateCss = {};\r\n                animateAlign = opt.animateAlign;\r\n                if( animateAlign == 'bottom' ){\r\n                    animateCss = {\r\n                        top: that.parentHeight + that.warpperHeight,\r\n                        left: support.toNumber(opt.left, that.parentWidth - that.warpperWidth)\r\n                    }\r\n                }else if( animateAlign == 'top' ){\r\n                    animateCss = {\r\n                        top: -that.parentHeight,\r\n                        left: support.toNumber(opt.left, that.parentWidth - that.warpperWidth)\r\n                    }\r\n                }else if( animateAlign == 'left' ){\r\n                    animateCss = {\r\n                        top: support.toNumber(opt.top, that.parentHeight - that.warpperHeight),\r\n                        left: -that.warpperWidth\r\n                    }\r\n                }else if( animateAlign == 'right' ){\r\n                    animateCss = {\r\n                        top: support.toNumber(opt.top, that.parentHeight - that.warpperHeight),\r\n                        left: that.parentWidth + that.warpperWidth\r\n                    }\r\n                }\r\n                $el.css( animateCss );\r\n\r\n                $el.animate( that._setCss(opt.top, opt.left), opt.delay );\r\n            }else{\r\n                $el.css( that._setCss(opt.top, opt.left), opt.delay );\r\n            }\r\n\r\n            // button focus\r\n            try {\r\n                if( buttonArr ) that.$focus.focus();\r\n            }catch( e ){}\r\n        },\r\n        // shade html\r\n        _shadeHtml: function( id ){\r\n            var that = this,\r\n                shade = $( '<div class=\"xcy-shade\" id=\\\"'+ id +'\\\"></div>' );\r\n\r\n            that._shadeCss( shade );\r\n            that.$shade = shade;\r\n            // set id\r\n            // shade.css( { width: width, height: height, opacity: opacity, 'z-index': that._zIndex } );\r\n\r\n            that.$parent.append( shade );\r\n        },\r\n        _shadeCss: function( el ){\r\n            var that = this,\r\n                opacity = that.options.opacity,\r\n                isBody = that._isBody,\r\n                width = isBody ? $('body').outerWidth() : that.$parent[0].scrollWidth,\r\n                height = isBody ? $doc.innerHeight() : that.$parent[0].scrollHeight;\r\n\r\n            // that._getParentSize();\r\n            // set shade css\r\n            el.css( { width: width, height: height, opacity: opacity, 'z-index': that._zIndex } );\r\n        },\r\n        // load html\r\n        _loadHtml: function( html ){\r\n            var that = this,\r\n                opt = that.options,\r\n                node = $( '<div class=\"xcy-load\"><span class=\"xcy-load-img\"></span><span>'+html+'</span></div>' );\r\n\r\n            // 转换宽高为数字\r\n            that._toNumberW( opt.width );\r\n            that._toNumberH( opt.height ); \r\n            // set content css\r\n            that._setCssSize( node );\r\n\r\n            return node;\r\n        },\r\n        _iframeHtml: function( src ){\r\n            var that = this,\r\n                opt = that.options,\r\n                $iframe = $('<iframe allowtransparency=\"true\" frameborder=\"0\" class=\"xcy-iframe\" name=\"xcy-iframe-' \r\n                    + that._cid +'\"  src=\"'+src+'\" scrolling=\"'+opt.scrolling+'\"></iframe>');\r\n\r\n                // 添加 iframe 对象\r\n                that.$iframe = $iframe;\r\n\r\n            return that._conHtml( '' ).html( $iframe );\r\n        },\r\n        // content html\r\n        _conHtml: function( html ){\r\n            var that = this,\r\n                opt = that.options,\r\n                node = $( '<div class=\"xcy-content\"><div class=\"xcy-main\"></div></div>' ),\r\n                display, prev, next, parent;\r\n\r\n            // element remove save node info \r\n            if( html && html.nodeType === 1 ){\r\n                display = html.style.display;\r\n                prev = html.previousSibling;\r\n                next = html.nextSibling;\r\n                parent = html.parentNode;\r\n                that._elemBack = function () {\r\n                    if (prev && prev.parentNode) {\r\n                        prev.parentNode.insertBefore( html, prev.nextSibling);\r\n                    } else if (next && next.parentNode) {\r\n                        next.parentNode.insertBefore( html, next);\r\n                    } else if (parent) {\r\n                        parent.appendChild( html );\r\n                    }\r\n                    html.style.display = display;\r\n                    that._elemBack = null;\r\n                };\r\n            }\r\n\r\n            // set content html\r\n            node.find( '.xcy-main' ).html( html );\r\n            // add icon\r\n            if( opt.icon ){\r\n                node.addClass('xcy-icon-box')\r\n                node.append('<div class=\"xcy-icon-default xcy-icon-'+opt.icon+'\"></div>')\r\n            }\r\n\r\n            return node;\r\n        },\r\n        // title html\r\n        _titHtml: function( title ){\r\n            var that = this,\r\n                node = $( '<div class=\"xcy-title\"></div>' );\r\n\r\n            node.append( '<span title=\\\"'+ title +'\\\">'+ title +'</span>' );\r\n\r\n            return node;\r\n        },\r\n        // button html\r\n        _btnHtml: function( buttonArr ){\r\n            var that = this,\r\n                node = $( '<div class=\"xcy-foot\"></div>' ),\r\n                html = '',\r\n                len = buttonArr.length - 1;\r\n\r\n            // button html\r\n            $.each( buttonArr, function( i, v ){\r\n                var disabled = v.disabled ? 'disabled' : '',\r\n                    className = '';\r\n                if( i === 0 ){\r\n                    className = 'xcy-btn-r';\r\n                }else if( i == len ){\r\n                    className = 'xcy-btn-l';\r\n                }else{\r\n                    className = 'xcy-btn-m';\r\n                }\r\n                html += '<button class=\"xcy-btn '+ className +'\" type=\"button\" '+ disabled +'>'+ v.name +'</button>';\r\n            });\r\n\r\n            // button html\r\n            node.html( html );\r\n            // text align direction\r\n            node.css( 'text-align', that.options.align );\r\n\r\n            // bind callback event\r\n            $( 'button', node ).each(function(i){\r\n                var $ele = $( this ),\r\n                    obj = buttonArr[ i ],\r\n                    isReturn, callback, val;\r\n\r\n                $ele.click(function( e ){\r\n                    callback = obj.callback;\r\n                    val = $( '.xcy-input', that._getContent() ).val();\r\n\r\n                    // return callback\r\n                    if( callback ) isReturn = callback( $ele.text(), val );\r\n\r\n                    if( isReturn === false ){\r\n                        return;\r\n                    }else{\r\n                        that.close();\r\n                    }\r\n                });\r\n\r\n                // focus\r\n                if( obj.focus && !obj.disabled ){\r\n                    that.$focus = $ele;\r\n                }\r\n            })\r\n\r\n            return node;\r\n        },\r\n        _winBtnHtml: function( type ){\r\n            var that = this,\r\n                opts = that.options,\r\n                closeBtnFn = opts.closeBtnFn,\r\n                winBtn = opts.winBtn,\r\n                node = $( '<div class=\"xcy-winBtn\"></div>' ),\r\n                state = true,\r\n                msgClass = 'xcy-close-btn';\r\n\r\n            // min max\r\n            if( type == 'iframe' && winBtn ){\r\n                node.append( '<a class=\"xcy-winBtn-btn\" id=\"xcy-min-btn\" href=\"javascript:;\">-</a>' );\r\n                node.append( '<a class=\"xcy-winBtn-btn\" id=\"xcy-full-btn\" href=\"javascript:;\">+</a>' );\r\n            }\r\n            // if type is msg or page, change close class\r\n            if( ( type == 'msg' && opts.title === false ) || (type == 'page' && opts.title === false) )\r\n                msgClass = 'xcy-x-btn';\r\n            \r\n            // close\r\n            node.append( '<a class=\"xcy-winBtn-btn\"  id=\\\"'+ msgClass +'\\\" href=\"javascript:;\">×</a>' );\r\n\r\n            $( 'a', node ).bind( 'click', function( e ){\r\n                var id = $( this ).attr( 'id' ),\r\n                    isReturn = true;\r\n\r\n                switch( id ){\r\n                    case 'xcy-close-btn':\r\n                    case 'xcy-x-btn':\r\n                        // return callback\r\n                        if( closeBtnFn ) isReturn = closeBtnFn( that.title() );\r\n\r\n                        if( isReturn === false ){\r\n                            return;\r\n                        }else{\r\n                            that.close();\r\n                        }\r\n                        break;\r\n                    case 'xcy-full-btn':\r\n                        // if( state ){\r\n                            that.full();\r\n                            $( this ).attr( 'id', 'xcy-restore-btn' )\r\n                            $( '#xcy-min-btn', that.$el ).show();\r\n                            // state = false;\r\n                        // }else{\r\n                        //     $( '#xcy-min-btn', that.$el ).show();\r\n                        //     that.restore();\r\n                        //     state = true;\r\n                        // }\r\n                        break;\r\n                    case 'xcy-restore-btn':\r\n                        that.restore();\r\n                        $( this ).attr( 'id', 'xcy-full-btn' )\r\n                        $( '#xcy-min-btn', that.$el ).show();\r\n                        break;\r\n                    case 'xcy-min-btn':\r\n                        $( this ).hide();\r\n                        that.min();\r\n                        $( this ).next().attr( 'id', 'xcy-restore-btn' )\r\n                        break;\r\n                }\r\n            });\r\n\r\n            return node;\r\n        },\r\n        _move: function(){\r\n            var that = this,\r\n                opt = that.options,\r\n                _drag = opt.drag,\r\n                $el = that.$el;\r\n\r\n            // set drag value\r\n            $.extend( _drag, {\r\n                selector: that.$proxy,\r\n                container: opt.container,\r\n                fixed: opt.fixed,\r\n                target: $('.xcy-title', $el),\r\n                isBody: that._isBody\r\n            })\r\n            _drag.onStart = function( $drag ){\r\n                // $drag.css({ top: that.top, left: that.left })\r\n                $el.hide();\r\n            };\r\n            var onMove = _drag.onMove;\r\n            _drag.onMove = function( t, l ){\r\n                // clearTimeout(timeStep)\r\n                // showProxy()\r\n                that.top = t;\r\n                that.left = l;\r\n                onMove( t, l );\r\n            };\r\n            _drag.onEnd = function( t, l ){\r\n                // t = t - $doc.scrollTop();\r\n                // l = l - $doc.scrollLeft();\r\n\r\n                that.$el.css({ top: t, left: l });\r\n\r\n                // set _restore 修改原始位置\r\n                that._restore.top = t;\r\n                that._restore.left = l;\r\n                $el.show();\r\n            };\r\n\r\n            // drag drop init\r\n            that._dragObj = new DragDrop( _drag );\r\n        },\r\n        _topFixed: function( parent ){\r\n            var that = this,\r\n                _top, Fix;\r\n\r\n            // client top\r\n            Fix = function(){\r\n                \r\n                support.debounce( function(){\r\n                    that.$el.css({\r\n                        top: that.top + parent.scrollTop(),\r\n                        left: that.left + parent.scrollLeft()\r\n                    })\r\n                    // that.$el.animate({\r\n                    //     top: that.top + parent.scrollTop(),\r\n                    //     left: that.left + parent.scrollLeft()\r\n                    // })  \r\n                })();\r\n            };\r\n\r\n            return Fix;\r\n        },\r\n        // ie6 select not mask with div tag\r\n        _ie6SelectFix: function(){\r\n            var that = this,\r\n                $el = that.$el,\r\n                width = that.warpperWidth,\r\n                height = that.warpperHeight,\r\n                iframe;\r\n\r\n            // iframe = $el.append(document.createElement('iframe'));\r\n            iframe = document.createElement('iframe');\r\n            iframe.src = 'about:blank;';\r\n            iframe.style.cssText = 'position:absolute;z-index:-1;left:0;top:0;'\r\n            + 'filter:alpha(opacity=0);border:0 none;width:' + width + 'px;height:' + height +'px;';\r\n\r\n            $el.append( iframe );\r\n        },\r\n        // 宽度百分比转换数字\r\n        _toNumberW: function( w ){\r\n            var that = this,\r\n                conW, //内容宽\r\n                overW;\r\n\r\n            // warpper 大小\r\n            that._getWarpperSize( that.$el );\r\n\r\n            that._getConWidth();\r\n           \r\n            // % percent conver to number\r\n            if( w ){\r\n                if( String(w).indexOf('%') !== -1 ){\r\n                    conW = that.width;\r\n                    overW = that.warpperWidth - conW;\r\n                    w = support.toNumber( w, that.parentWidth -overW );\r\n                }\r\n                that.width = Number(w);\r\n            }\r\n        },\r\n        // 高度百分比转换数字\r\n        _toNumberH: function( h ){\r\n            var that = this,\r\n                conH, //内容宽\r\n                overH;\r\n\r\n            // warpper 大小\r\n            that._getWarpperSize( that.$el );\r\n\r\n            that._getConHeight();\r\n\r\n            // % percent conver to number\r\n            if( h ){\r\n                if( String(h).indexOf('%') !== -1 ){\r\n                    conH = that.height;\r\n                    overH = that.warpperHeight - conH;\r\n                    h = support.toNumber( h, that.parentHeight -overH );\r\n                }\r\n                that.height = Number(h);\r\n            }\r\n        },\r\n        // set content css\r\n        _setCssSize: function( el ){\r\n            var that = this,\r\n                cssObj = that.css;\r\n\r\n            // 宽高分开渲染，不然高度受宽度影响获取值不对\r\n            // that._toNumberW( w );\r\n            el.css( { width: that.width, height: that.height } );\r\n\r\n            // that._toNumberH( h );\r\n            // el.css( { height: that.height } );\r\n        },\r\n        // set warpper css\r\n        _setCss: function( t, l ){\r\n            var that = this,\r\n                opt = that.options,\r\n                $parent = that.$parent,\r\n                isBody = that._isBody,\r\n                dt = 0,\r\n                dl = 0,\r\n                cssObj = {};\r\n\r\n            if( opt.fixed && _isIE6 ){\r\n                dt = isBody ? $doc.scrollTop() : that.$parent.scrollTop();\r\n                dl = isBody ? $doc.scrollLeft() : that.$parent.scrollLeft();\r\n            }\r\n\r\n            // top\r\n            if( t === undefined || t === '' ){\r\n                t = '50%';\r\n            }\r\n            // top % to number\r\n            t = support.toNumber( t, that.parentHeight - that.warpperHeight );\r\n            that.top = t;\r\n\r\n            // left\r\n            if( l === undefined || l === '' ){\r\n                l = '50%';\r\n            }\r\n            // left % to number\r\n            l = support.toNumber( l, that.parentWidth - that.warpperWidth );\r\n            that.left = l;\r\n\r\n            cssObj[ 'z-index' ] = that._zIndex;\r\n\r\n            cssObj[ 'top' ] = t + dt;\r\n            cssObj[ 'left' ] = l + dl;\r\n\r\n            return cssObj;\r\n        },\r\n        // 获取dialog content容器宽度\r\n        _getConWidth: function(){\r\n            var that = this;\r\n\r\n            that.width = that._getContent().width();\r\n        },\r\n        // 获取dialog content容器高度\r\n        _getConHeight: function(){\r\n            var that = this;\r\n\r\n            that.height = that._getContent().height();\r\n        },\r\n        // 获取dialog父级可视大小\r\n        _getParentSize: function(){\r\n            var that = this,\r\n                opt = that.options,\r\n                $parent = that.$parent,\r\n                isBody = that._isBody;\r\n\r\n            // this.parentWidth = isClient ? ( document.documentElement.clientWidth || document.body.clientWidth ) : $parent[0].clientWidth;\r\n            // this.parentHeight = isClient ? ( document.documentElement.clientHeight || document.body.clientHeight ) : $parent[0].clientHeight;\r\n            that.parentWidth = isBody ? $win.innerWidth() : $parent[0].clientWidth;\r\n            that.parentHeight = isBody ? $win.innerHeight() : $parent[0].clientHeight;\r\n        },\r\n        // 获取dialog大小\r\n        _getWarpperSize: function( el ){\r\n            this.warpperWidth = el.outerWidth();\r\n            this.warpperHeight = el.outerHeight();\r\n        },\r\n        min: function(){\r\n\r\n            this.resize( '180', '0', this.top, this.left );\r\n        },\r\n        full: function(){\r\n\r\n            this.resize( '100%', '100%', 0, 0 );\r\n        },\r\n        restore: function(){\r\n            var that = this,\r\n                restore = that._restore;\r\n\r\n            that.resize( restore.width, restore.height, restore.top, restore.left );\r\n        },\r\n        title: function( title ){\r\n            var el = this._getTitle().children( 'span' );\r\n\r\n            var newTitle = title ? el.html( title ) : el.html();\r\n\r\n            return title ? this : newTitle;\r\n        },\r\n        html: function( html ){\r\n            this._getContent().html( html );\r\n\r\n            return this;\r\n        },\r\n        buttons: function( buttonArr ){\r\n            $( 'button', this.$el ).unbind( 'click' );\r\n            this._getFoot().replaceWith( this._btnHtml( buttonArr ) );\r\n\r\n            return this;\r\n        },\r\n        resize: function( w, h, t, l, isdrag ){\r\n            var that = this,\r\n                offL = parseInt( that.$el.css( 'left' ) ),  //left\r\n                offT = parseInt( that.$el.css( 'top' ) ),\r\n                conW, conH, //内容宽\r\n                diffH, diffW,\r\n                overH, overW,\r\n                left, top, box;\r\n\r\n            // restore\r\n            // that._restore = {top: that.top, left: that.left, height: that.height, width: that.width };\r\n\r\n            // 宽高转换数字\r\n            that._toNumberW( w );\r\n            that._toNumberH( h );\r\n\r\n            conW = that.width, //内容宽\r\n            conH = that.height,\r\n\r\n            this.options.height = h;\r\n            this.options.width = w;            \r\n\r\n            // 除内容外的宽度/2\r\n            // diffW = (conW - w)/2;\r\n            // diffH = (conH - h)/2;\r\n            // // exist l and t 指定位置\r\n            // // no exist [ offL + diffW ]\r\n            // left = l !== undefined ? l : offL + diffW;\r\n            // top = t !== undefined ? t : offT + diffH;\r\n           \r\n            // t = that.oTop;\r\n            // l = that.oLeft;\r\n            \r\n// console.log( that._restore );\r\n\r\n            // set content css\r\n            that._setCssSize( that._getContent() );\r\n            // reset warpper size\r\n            that._getWarpperSize( that.$el );\r\n            // exist l and t 指定位置\r\n            // no exist [ offL + diffW ]\r\n            box = that._setCss( t, l );\r\n            top = box.top;\r\n            left = box.left;\r\n\r\n            that.$proxy.css({\r\n                left: left,\r\n                top: top,\r\n                width: that.warpperWidth,\r\n                height: that.warpperHeight\r\n            })\r\n\r\n            // move positon\r\n            // if( !this._dragObj || isdrag ){\r\n                // console.log( top, left, that.warpperHeight, that.warpperWidth )\r\n                // that.$el.css( that._setCss( top, left ) );\r\n                that.$el.css({\r\n                    top: top,\r\n                    left: left\r\n                });\r\n            // }else{\r\n                // that._dragObj._move( top, left, that.warpperHeight, that.warpperWidth );\r\n                // that._dragObj._end( top, left );\r\n            // }\r\n\r\n            return this;\r\n        },\r\n        moveTo: function( t, l ){\r\n            var that = this;\r\n\r\n            // % percent conver to number\r\n            t = support.toNumber( t, that.parentHeight );\r\n            l = support.toNumber( l, that.parentWidth );\r\n\r\n            // get drag layer limit range\r\n            if( !this._dragObj ){\r\n                box = that._setCss( t, l );\r\n            }else{\r\n                box = that._dragObj.range( t, l, that.warpperWidth, that.warpperHeight );\r\n            }\r\n\r\n            // set warpper css\r\n            that.$el.css( that._setCss( box.top, box.left ) );\r\n\r\n            return this;\r\n        },\r\n        setDrag: function( o ){\r\n            if( !this._dragObj ) return this;\r\n\r\n            this._dragObj.set( o );\r\n\r\n            return this;\r\n        },\r\n        hide: function(){\r\n            $.each( this.$elArr, function( i, v ){\r\n                $( v ).hide();\r\n            })\r\n\r\n            return this;\r\n        },\r\n        show: function(){\r\n            $.each( this.$elArr, function( i, v ){\r\n                $( v ).show();\r\n            })\r\n\r\n            return this;\r\n        },\r\n        close: function(){\r\n            var that = this;\r\n\r\n            if( that.timer ){\r\n                clearTimeout( that.timer )\r\n                that.timer = null;\r\n            }\r\n            that.closed = null;\r\n\r\n            // not unload\r\n            if( !that.options.unload ){\r\n                that.hide();\r\n                return;\r\n            }\r\n\r\n            // unload\r\n            that.unload();\r\n        },\r\n        unload: function(){\r\n            var that = this, t;\r\n\r\n            // unbind input buttons click event\r\n            $( 'button', that.$el ).unbind( 'click' );\r\n            $( '.xcy-winBtn a', that.$el ).unbind( 'click' );\r\n            that.$el.unbind( 'mousedown' );\r\n\r\n            // unbind window event\r\n            if( that._winResize ){\r\n                $win.unbind( 'resize', that._winResize );\r\n            }\r\n            if( that._ie6Fix ){\r\n                $win.unbind( 'scroll', that._ie6Fix );\r\n                that.$parent.unbind( 'scroll', that._ie6Fix ); \r\n            }\r\n            \r\n            // unbind shade\r\n            that.options.shadeClose && $( '.xcy-shade', that.$parent ).unbind( 'click' );\r\n\r\n            // unbind drag click event\r\n            that.options.isMove && that._dragObj.disable();\r\n            // if html is element, back move position\r\n            that._elemBack && that._elemBack();\r\n\r\n            // 低版本ie 内存回收 iframe\r\n            if( that.type === 'iframe' ){\r\n                try {\r\n                    var iframe = that.$iframe[0];\r\n                    iframe.contentWindow.document.write('');\r\n                    iframe.contentWindow.close();\r\n                    that.$iframe.remove();\r\n                } catch(e){}\r\n            }\r\n            // remove dom\r\n            $.each( that.$elArr, function( i, v ){\r\n                $( v ).remove();\r\n            })\r\n            that.$elArr = null;\r\n            that.$proxy.remove();\r\n            that.$proxy = null;\r\n\r\n            // delete global array object\r\n            t = layers.length;\r\n            while( t-- ){\r\n                if( layers[ t ]._cid === this._cid ){\r\n                    layers.splice( t, 1 );\r\n                }\r\n            }\r\n\r\n        },\r\n        closeAll: function(){\r\n            $.each( layers, function( i, v ){\r\n                v.close();\r\n            })\r\n        }\r\n    }\r\n\r\n    // drag layer\r\n    var DragDrop = (function( options ){\r\n\r\n        /**\r\n         * [dragdrop description]\r\n         * @param  {[type]} options [description]\r\n         * @return {[type]}         [description]\r\n         */\r\n        function dragdrop( options ){\r\n            var that = this;\r\n\r\n            that.diffx = 0;\r\n            that.diffy = 0;\r\n            that.options = options;\r\n            that.$drag = typeof options.selector === 'string' ? $( options.selector ) : options.selector;\r\n            that.$target = typeof options.selector === 'string' ? $( options.target ) : options.target;\r\n            that._handleEvent = _handleEvent;\r\n\r\n            that._init();\r\n\r\n            // handle event\r\n            function _handleEvent( e ){\r\n                var type = e.type,\r\n                    _self = that,\r\n                    $target = $( e.target ),\r\n                    className = that.$target.attr('class'),\r\n                    $el;\r\n\r\n                // target is tit childer\r\n                if( $target.parents( '.xcy-drag' ).length !== 0 ){\r\n                    $el = $target.parents( '.xcy-drag' );\r\n                // target is tit\r\n                }else{\r\n                    $el = $target;\r\n                }\r\n\r\n                switch( type ){\r\n                    case 'mousedown':\r\n                        // bind start event\r\n                        that.options.onStart( that.$drag );\r\n\r\n                        if( $el.hasClass( 'xcy-drag' ) ){\r\n\r\n                            that.$drag.removeClass('xcy-proxy-hidden');\r\n                            // console.log(that.$target[0].getBoundingClientRect())\r\n                            // mouse clientx - drag layer offset left\r\n                            that.diffx = e.clientX - that.$drag[0].offsetLeft;\r\n                            that.diffy = e.clientY - that.$drag[0].offsetTop;\r\n                            // afresh size\r\n                            that._getOffSize();\r\n                   \r\n                            // clear selected text\r\n                            window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\r\n                            \r\n                            // window capture focus\r\n                            if( _isIE ){\r\n                                that.$drag.bind( 'losecapture', that._end );\r\n                                that.$drag[0].setCapture();\r\n                            }else{\r\n                                $doc.bind( 'blur', that._end );\r\n                            }\r\n\r\n                            $doc.bind( 'mousemove', that._handleEvent );\r\n                            $doc.bind( 'mouseup', that._handleEvent );\r\n\r\n                            e.preventDefault();\r\n                        }\r\n                        break;\r\n                    case 'mousemove':\r\n                        var l = e.clientX - that.diffx,\r\n                            t = e.clientY - that.diffy;\r\n\r\n                        that._move( t, l, that.dragH, that.dragW );\r\n\r\n                        e.preventDefault();\r\n                        break;\r\n                    case 'mouseup':\r\n                        // dragable proxy hidden\r\n                        that.$drag.addClass('xcy-proxy-hidden');\r\n\r\n                        that._end();\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        dragdrop.prototype = {\r\n            _init: function(){\r\n                var that = this;\r\n\r\n                that._size();\r\n\r\n                // $tit.attr( 'data-move', 'true' );\r\n                // $tit.css( 'cursor', 'move' );\r\n                that.$target.addClass( 'xcy-drag' );\r\n                // mousedown event\r\n                that.$target.bind( 'mousedown', that._handleEvent );\r\n            },\r\n            _getActive: function () {\r\n                try {// try: ie8~9, iframe bug\r\n                    var activeElement = document.activeElement,\r\n                        contentDocument = activeElement.contentDocument,\r\n                        elem = contentDocument && contentDocument.activeElement || activeElement;\r\n                    return elem;\r\n                } catch (e) {}\r\n            },\r\n            _size: function(){\r\n                var that = this,\r\n                    opt = that.options,\r\n                    range = opt.range,\r\n                    $container;\r\n\r\n                // limit range\r\n                if( !opt.limit ) return;\r\n\r\n                that.mxT = range[0];\r\n                that.mxR = range[1] !== undefined ? range[1] : range[0];\r\n                that.mxB = range[2] !== undefined ? range[2] : range[0];\r\n                that.mxL = range[3] !== undefined ? range[3] : range[1] ? range[1] : range[0];\r\n\r\n                // that.marginL = parseInt( that.$parent.css( 'marginLeft' ) );\r\n                // that.marginT = parseInt( that.$parent.css( 'marginTop' ) );\r\n\r\n                that._getOffSize();\r\n\r\n                // container\r\n                // if( opt.container ){\r\n                    // $container = opt.fixed ? $( 'body' ) : $( opt.container );\r\n                    $container = $( opt.container );\r\n\r\n                    // client element 可视范围dom对象\r\n                    if( !opt.fixed && opt.isBody ){\r\n                        // scroll range value值\r\n                        that.h = $doc.outerHeight();\r\n                        that.w = $doc.outerWidth();\r\n\r\n                    }else if( opt.fixed && opt.isBody ){\r\n                        that.h = $win.innerHeight();\r\n                        that.w = $win.innerWidth();\r\n\r\n                    }else{\r\n                        // client range value值\r\n                        that.h = $container[0].scrollHeight;\r\n                        that.w = $container[0].scrollWidth;\r\n                    }\r\n\r\n                    // container css style position\r\n                    $container.css( 'position' ) == 'relative' && $container.css( 'position', 'relative' );\r\n\r\n                // }\r\n\r\n                // lock x axis\r\n                if( opt.lockX ) that.mxR = that.mxL = that.left;\r\n                // lock y axis\r\n                if( opt.lockY ) that.mxT = that.mxB = that.top;\r\n            },\r\n            _getOffSize: function(){\r\n                var that = this;\r\n\r\n                // get parent width and height value\r\n                that.dragW = that.$drag.outerWidth();\r\n                that.dragH = that.$drag.outerHeight();\r\n                // left top\r\n                that.left = parseInt( that.$drag.css( 'left' ) );\r\n                that.top = parseInt( that.$drag.css( 'top' ) );\r\n\r\n                // reprai 修正右下limit range值\r\n                // limit right值: 右限制最大值\r\n                // limit left值 + 拖动容器width值: 右限制范围最小值\r\n                that.mxR = Math.max( that.mxR, that.mxL + that.dragW );\r\n                that.mxB = Math.max( that.mxB, that.mxT + that.dragH );\r\n            },\r\n            _move: function( t, l, dragH, dragW ){\r\n                var that = this,\r\n                    position, left, top;\r\n\r\n                // left and top value\r\n                position = that.range( t, l, dragW, dragH );\r\n                left = position.left;\r\n                top = position.top;\r\n\r\n                that.$drag.css( {'left': left, 'top': top} );\r\n                that.left = left;\r\n                that.top = top;\r\n\r\n                that.options.onMove( that.top, that.left );\r\n            },\r\n            // drag end, unbind event\r\n            _end: function(){\r\n                var that = this;\r\n\r\n                $doc.unbind( 'mousemove', that._handleEvent );\r\n                $doc.unbind( 'mouseup', that._handleEvent );\r\n\r\n                if( _isIE ){\r\n                    that.$drag.unbind( 'losecapture', that._end );\r\n                    that.$drag[0].releaseCapture();\r\n                }else{\r\n                    $doc.unbind( 'blur', that._end );\r\n                }\r\n\r\n                that.options.onEnd(that.top, that.left);\r\n            },\r\n            range: function( t, l, dragW, dragH ){\r\n                var that = this,\r\n                    opt = that.options,\r\n                    obj = {},\r\n                    mxT, mxR, mxL, mxB;\r\n\r\n                // scroll top\r\n                // if( !opt.fixed ){\r\n                //     st = $doc.scrollTop();\r\n                //     sl = $doc.scrollLeft();\r\n                // }\r\n\r\n                if( opt.limit ){\r\n\r\n                    mxT = that.mxT;\r\n                    mxR = that.mxR;\r\n                    mxL = that.mxL;\r\n                    mxB = that.mxB;\r\n\r\n                    if( opt.container ){\r\n                        // [ limit range , container range ] 容器最小活动范围\r\n                        mxT = Math.max( that.mxT, 0 );\r\n                        mxR = Math.min( that.w - dragW, that.mxR - dragW );\r\n                        mxL = Math.max( that.mxL, 0 );\r\n                        mxB = Math.min( that.h - dragH, that.mxB - dragH );\r\n                    }\r\n\r\n                    // 获取drag时正确的范围值\r\n                    l = Math.max(Math.min( l, mxR ), mxL );\r\n                    t = Math.max(Math.min( t, mxB ), mxT );\r\n                }\r\n\r\n                obj.left = l;\r\n                obj.top = t;\r\n                obj.width = dragW;\r\n                obj.height = dragH;\r\n\r\n                return obj;\r\n            },\r\n            // set attribute options\r\n            set: function( options ){\r\n                var that = this;\r\n\r\n                options && $.extend( that.options, options );\r\n                that._size();\r\n            },\r\n            // bind event\r\n            enable: function(){\r\n                var that = this;\r\n\r\n                that.$drag.bind( 'mousedown', that._handleEvent );\r\n            },\r\n            // unbind event\r\n            disable: function(){\r\n                var that = this;\r\n\r\n                that.$drag.unbind( 'mousedown', that._handleEvent ); \r\n            }\r\n        }\r\n\r\n        return dragdrop;\r\n\r\n    })();\r\n\r\n    var dialog = {\r\n        create: function( options ){\r\n            var dl = new DialogLayer( options );\r\n            // save global dialog\r\n            // layers.push( dl );\r\n            return dl;\r\n        },\r\n        load: function( msg, delay, shade, shadeClose ){\r\n            // delay is not exist\r\n            return Dialog.create({\r\n                type: 'load',\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: shade || false,\r\n                shadeClose: shadeClose || true,\r\n                delay: typeof delay !== 'undefined' ? delay : false\r\n            })\r\n        },\r\n        prompt: function( msg, val, ok, cancel ){\r\n            return Dialog.create({\r\n                type: 'prompt',\r\n                html: msg,\r\n                value: val,\r\n                fixed: true,\r\n                width: 300,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: ok,\r\n                        disabled: false,\r\n                        focus: true\r\n                    },\r\n                    {\r\n                        name: '取消',\r\n                        callback: cancel,\r\n                        disabled: false,\r\n                        focus: false\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        confirm: function( msg, ok, cancel ){\r\n\r\n            return Dialog.create({\r\n                type: 'confirm',\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: ok,\r\n                        disabled: false,\r\n                        focus: true\r\n                    },\r\n                    {\r\n                        name: '取消',\r\n                        callback: cancel,\r\n                        disabled: false,\r\n                        focus: false\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        alert: function( msg, config, callback ){\r\n            // title is not exist\r\n            if( typeof config === 'function' ){\r\n                callback = config;\r\n                config = {};\r\n                config.title = Default.title;\r\n            }\r\n\r\n            return Dialog.create({\r\n                type: 'alert',\r\n                html: msg,\r\n                icon: config.icon || false,\r\n                fixed: true,\r\n                title: config.title,\r\n                unload: true,\r\n                shade: config.shade === false ? false : true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: callback,\r\n                        disabled: false,\r\n                        focus: true\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        msg: function( msg, delay, shade ){\r\n            // delay is not exist\r\n            delay = typeof delay !== 'undefined' ? delay : true;\r\n\r\n            return Dialog.create({\r\n                type: 'msg',\r\n                title: false,\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: shade || false,\r\n                closeBtnFn: !delay ? function(){} : false,\r\n                delay: delay,\r\n                isMove: false\r\n            })\r\n        },\r\n        // config default param\r\n        config: function( config ){\r\n            return $.extend( Default, config );\r\n        }\r\n    }\r\n\r\n    'function' === typeof define? define(function(){\r\n        return dialog;\r\n    }) : window.Dialog = dialog;\r\n    \r\n})()"],"sourceRoot":"/source/"}