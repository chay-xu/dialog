{"version":3,"sources":["pc/dialog.js"],"names":["DialogLayer","options","opt","that","this","$","extend","Default","css","type","$parent","container","length","$el","dialogHtml","addClass","className","_isBody","nodeName","fixed","isMove","_cid","_zIndex","$elArr","beforeFn","apply","init","layers","push","afterFn","_isIE","_isIE6","window","XMLHttpRequest","$doc","document","$win","padding","html","value","title","left","top","src","scrolling","align","animate","animateAlign","winBtn","buttons","name","callback","disabled","focus","closeBtn","onloadFn","shade","shadeClose","unload","delay","opacity","resize","drag","limit","range","lockX","lockY","onStart","onMove","onEnd","support","sort","cid","j","len","each","i","obj","console","log","$proxy","$shade","toNumber","maxValue","last","lastIndexOf","parseInt","split","debounce","context","timeout","runIt","clearTimeout","setTimeout","prototype","v","constructor","_drag","id","borderWidth","showShade","_shadeHtml","_bindShadeClose","_layerHtml","attr","find","outerWidth","width","warpperWidth","height","warpperHeight","zIndex","append","_ie6Fix","_topFixed","bind","_ie6SelectFix","_winResize","_dragObj","_size","ph","parentHeight","pw","parentWidth","t","Number","l","_getParentSize","nph","npw","Math","round","_setCss","_shadeCss","_restore","_move","$iframe","iframe","attachEvent","detachEvent","arguments","caller","onload","timer","_autoClose","closed","close","parent","e","_getContent","_getTitle","_getFoot","content","buttonArr","tit","con","btn","animateCss","cssObj","isTitle","_titHtml","_loadHtml","_iframeHtml","_conHtml","_btnHtml","_winBtnHtml","_toNumberW","_toNumberH","_setCssSize","_getWarpperSize","$focus","el","isBody","scrollWidth","innerHeight","scrollHeight","z-index","node","display","prev","next","nodeType","style","previousSibling","nextSibling","parentNode","_elemBack","insertBefore","appendChild","icon","isReturn","val","$ele","click","text","opts","msgClass","full","show","restore","hide","min","selector","target","$drag","DragDrop","Fix","scrollTop","scrollLeft","createElement","cssText","w","conW","overW","_getConWidth","String","indexOf","h","conH","overH","_getConHeight","dt","dl","undefined","innerWidth","clientWidth","clientHeight","outerHeight","children","newTitle","unbind","replaceWith","isdrag","box","moveTo","setDrag","o","set","disable","contentWindow","write","remove","splice","closeAll","dragdrop","_handleEvent","$target","parents","hasClass","removeClass","diffx","clientX","offsetLeft","diffy","clientY","offsetTop","_getOffSize","getSelection","removeAllRanges","selection","empty","_end","setCapture","preventDefault","dragH","dragW","_init","_getActive","activeElement","contentDocument","elem","$container","mxT","mxR","mxB","mxL","max","position","releaseCapture","enable","dialog","create","load","msg","Dialog","prompt","ok","cancel","confirm","alert","config","define"],"mappings":"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","file":"pc/dialog-min.js","sourcesContent":["/**\r\n * @file dialog plugin\r\n * @author xucaiyu\r\n * @email 569455187@qq.com\r\n * @version 2.5.0\r\n * @date 2015-10-10\r\n * @license MIT License \r\n */\r\n \r\n/** \r\n  * {\r\n  *     type: {string}\r\n  *     contain: {string}\r\n  *     html: {string}\r\n  *     fun: {\r\n  *         ok: {function},\r\n  *         cancel: {function}\r\n  *     }   \r\n  * }\r\n  */\r\n  \r\n;!(function(){  \r\n// function Dialog( options ){\r\n    var _cid = 1,\r\n        _zIndex = 99999900,\r\n        _zIndexc = 999900,\r\n        layers = [],\r\n        _isIE = !-[1,],\r\n        _isIE6 = _isIE && !window.XMLHttpRequest,\r\n        $doc = $( document ),\r\n        $win = $( window ),\r\n        Default = {\r\n            className: '',\r\n            container: 'body',\r\n            // css: {},\r\n            css: { padding: '10px' },\r\n            html: '加载中...',\r\n            value: '',\r\n            title: '信息',\r\n            left: '50%',\r\n            top: '50%',\r\n            src: 'about:blank',\r\n            scrolling: 'auto',\r\n            align: 'center',\r\n            animate: false,\r\n            animateAlign: 'bottom',\r\n            winBtn: true,\r\n            buttons: [\r\n                {\r\n                    name: '确定',\r\n                    callback: function(){},\r\n                    disabled: false,\r\n                    focus: false\r\n                }\r\n                // ,\r\n                // {\r\n                //     name: '取消',\r\n                //     callback: function(){},\r\n                //     disabled: false,\r\n                //     focus: false\r\n                // }\r\n            ],\r\n            closeBtn: function(){},         // 关闭图层执行\r\n            beforeFn: function(){},         // 初始化之前执行函数\r\n            onloadFn: function(){},         // iframe 页面加载完成执行\r\n            afterFn: function(){},          // 初始化之后执行函数\r\n            shade: true,\r\n            shadeClose: false,\r\n            unload: true,\r\n            delay: false,\r\n            opacity: 0.5,\r\n            fixed: false,\r\n            isMove: true,\r\n            resize: true,\r\n            drag: {\r\n                limit: true,\r\n                range: [ 0, 9999, 9999, 0 ],\r\n                // client: false,\r\n                lockX: false,\r\n                lockY: false,\r\n                onStart: function(){},\r\n                onMove: function(){},\r\n                onEnd: function(){}\r\n            }\r\n        },\r\n        dialogHtml;\r\n\r\n    dialogHtml = ''\r\n    // +'<div class=\"xcy-warpper\">'\r\n    +    '<table class=\"xcy-table xcy-warpper\">'\r\n    +        '<tbody>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-tl xcy-resize-item\" id=\"xcy-resize-tl\"></td>'\r\n    +                '<td class=\"xcy-tc xcy-resize-item\" id=\"xcy-resize-tc\"></td>'\r\n    +                '<td class=\"xcy-tr xcy-resize-item\" id=\"xcy-resize-tr\"></td>'\r\n    +            '</tr>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-cl xcy-resize-item\" id=\"xcy-resize-cl\"></td>'\r\n    +                '<td class=\"xcy-cc\">'\r\n    +                    '<div class=\"xcy-layer\">'\r\n    +                    '</div>'\r\n    +                '</td>'\r\n    +                '<td class=\"xcy-cr xcy-resize-item\" id=\"xcy-resize-cr\"></td>'\r\n    +            '</tr>'\r\n    +            '<tr>'\r\n    +                '<td class=\"xcy-bl xcy-resize-item\" id=\"xcy-resize-bl\"></td>'\r\n    +                '<td class=\"xcy-bc xcy-resize-item\" id=\"xcy-resize-bc\"></td>'\r\n    +                '<td class=\"xcy-br xcy-resize-item\" id=\"xcy-resize-br\"></td>'\r\n    +            '</tr>'\r\n    +        '</tbody>'\r\n    +    '</table>';\r\n    // +'</div>';\r\n\r\n    // support unit\r\n    var support = {\r\n        /**\r\n         * layers 层级冒泡 将被点击层提升z-index最高\r\n         * @param {string|number} dialog对象_cid\r\n         */\r\n        sort: function( cid ){\r\n            var len = layers.length,\r\n                j, _cid, _zIndex;\r\n\r\n            for( j = 0; j < len; j++ ){\r\n                // bubble key position\r\n                if( layers[ j ]._cid == cid ){\r\n                    // 如果是最后1位开始重新渲染\r\n                    if( j == len - 1 ){\r\n                        // if no change 如果原始位置就在最后1位立即返回\r\n                        if( !_cid ) return;\r\n                        // change z-inde style\r\n                        $.each( layers, function( i, obj ){\r\n                            obj.$el.css( 'zIndex', obj._zIndex );\r\n                            console.log('----',obj)\r\n                            obj.$proxy.css( 'zIndex', obj._zIndex );\r\n                            obj.$shade && obj.$shade.css( 'zIndex', obj._zIndex );\r\n                        });\r\n\r\n                        return;\r\n                    }\r\n\r\n                    // bubble\r\n                    _cid = layers[ j ];\r\n                    _zIndex = layers[ j+1 ]._zIndex;\r\n\r\n                    layers[ j ] = layers[ j+1 ];\r\n                    layers[ j+1 ] = _cid;\r\n\r\n                    layers[ j ]._zIndex = layers[ j+1 ]._zIndex;\r\n                    layers[ j+1 ]._zIndex = _zIndex;\r\n\r\n                }\r\n                \r\n            }\r\n        },\r\n        /**\r\n         * px and % to value of number\r\n         * @param {string|number} value 转换值\r\n         * @param {string|number} max value 最大值\r\n         * @return {number}\r\n         */\r\n        toNumber: function( value, maxValue ){\r\n            if (!value && value !== 0 || typeof value === 'number') {\r\n                return value;\r\n            }\r\n\r\n            var last = value.length - 1;\r\n            if ( value.lastIndexOf('px') === last - 1 ) {\r\n                value = parseInt(value);\r\n            } else if ( value.lastIndexOf('%') === last ) {\r\n                if( !maxValue ) maxValue = 100;\r\n                value = parseInt( maxValue * value.split('%')[0] / 100 );\r\n            }\r\n\r\n            return value;\r\n        },\r\n        /** \r\n         * window resize ie6~7 bug\r\n         * @param {Function} callback 回调函数 \r\n         * @param {Integer} delay   延迟时间，单位为毫秒(ms)，默认150 \r\n         * @param {Object} context  上下文，即this关键字指向的对象，默认为null \r\n         * @return {Function} \r\n         */ \r\n        debounce: function( callback, delay, context ){\r\n            if (typeof(callback) !== \"function\") {  \r\n                return;  \r\n            }\r\n\r\n            delay = delay || 150;  \r\n            context = context || null;  \r\n            var timeout,\r\n                runIt = function(){\r\n                    callback.apply(context);  \r\n                };  \r\n            return (function(){\r\n                window.clearTimeout(timeout);  \r\n                timeout = window.setTimeout(runIt, delay);  \r\n            });  \r\n        }    \r\n    };\r\n\r\n    function DialogLayer( options ){\r\n        var that = this,\r\n            $el, opt;\r\n\r\n        /**\r\n         * mix param\r\n         * drag css dialog\r\n         */\r\n        \r\n        // // drag\r\n        // var _drag = $.extend( {}, Default.drag, options.drag );\r\n        // // css\r\n        // that.css = $.extend( {}, Default.css, options.css );\r\n        // dialog\r\n        opt = $.extend( true, {}, Default, options );\r\n        that.css = opt.css;\r\n\r\n        that.options = opt;\r\n        that.type = opt.type;\r\n\r\n        // dialog parent\r\n        // that.$parent = $( opt.fixed ? 'body' : opt.container );\r\n        \r\n        that.$parent = (typeof opt.container === 'string') ? $( opt.container ) : opt.container;\r\n        if( this.$parent.length == 0 ) that.$parent = $('body');\r\n        // dialog warpper\r\n        that.$el =  $( dialogHtml );\r\n        that.$el.addClass( opt.className );\r\n\r\n        // fixed or limit choose\r\n        that._isBody = (this.$parent[0].nodeName == 'BODY');\r\n        if( (opt.fixed && !that._isBody) || that.type == 'msg' ) \r\n            that.options.isMove = false;\r\n\r\n        // private\r\n        that._cid = _cid++;\r\n        that._zIndex = _zIndex++;\r\n\r\n        // type layer id array\r\n        that.$elArr = [];\r\n        // init function 初始化之前执行的自定义函数\r\n        opt.beforeFn.apply( this );\r\n\r\n        that.init();\r\n        // save global dialog\r\n        layers.push( this );\r\n\r\n        // init function 初始化之后执行的自定义函数\r\n        opt.afterFn.apply( this );\r\n        options = null;\r\n    }\r\n    // dialog\r\n    DialogLayer.prototype = {\r\n        v: '2.0.5',\r\n        constructor: DialogLayer,\r\n        init: function( _drag ){\r\n            var that = this,\r\n                opt = that.options,\r\n                title = opt.title,\r\n                html = opt.html,\r\n                showShade = that.type == 'shade' || opt.shade,\r\n                $el = that.$el,\r\n                resize = opt.resize,\r\n                $tit, id, borderWidth;\r\n\r\n            // shade layer\r\n            if( showShade ){\r\n                id = 'shade-layer-'+ that._cid;\r\n\r\n                that.$elArr.push( '#'+id );\r\n\r\n                // that.shadeEvent( that.parent, id );\r\n                that._shadeHtml( id );\r\n                opt.shadeClose && that._bindShadeClose();\r\n            }\r\n            switch( that.type ){\r\n                case 'load':\r\n                    id = 'load-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( false, html, false );\r\n                    break;\r\n                case 'confirm':\r\n                    id = 'confirm-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'prompt':\r\n                    id = 'prompt-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'alert':\r\n                    id = 'alert-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, html, opt.buttons );\r\n                    break;\r\n                case 'msg':\r\n                    id = 'msg-layer-'+ that._cid;\r\n                \r\n                    that._layerHtml( title, html, false );\r\n                    break;\r\n                case 'iframe':\r\n                    id = 'iframe-layer-'+ that._cid;\r\n\r\n                    that._layerHtml( title, true, false );\r\n                    break;\r\n                default:\r\n                    id = 'page-layer-'+ that._cid;\r\n                \r\n                    that._layerHtml( title, html, false );\r\n            }\r\n            // push id\r\n            that.$elArr.push( '#'+id );\r\n\r\n            // set id\r\n            $el.attr( 'id', id );\r\n\r\n            // append drag proxy\r\n            borderWidth = $el.find('.xcy-cl').outerWidth(true) * 2;\r\n\r\n            that.$proxy = $('<div class=\"xcy-proxy xcy-proxy-hidden\"><div class=\"xcy-title xcy-drag\"><span>'+title+'</span></div></div>').css({\r\n                width: that.warpperWidth - borderWidth,\r\n                height: that.warpperHeight - borderWidth,\r\n                top: that.top,\r\n                left: that.left,\r\n                zIndex: that._zIndex\r\n            })\r\n            that.$parent.append( that.$proxy );\r\n\r\n            // container is body\r\n            // if( that.$parent[0].nodeName == 'BODY' ){\r\n                // fixed position\r\n                // layer滚动\r\n                if( opt.fixed ){\r\n                    // parent is body\r\n                    if( that._isBody ){\r\n                        \r\n                        // ie6的固定与相对定位 fixed\r\n                        if( _isIE6 ){\r\n                            that._ie6Fix = that._topFixed( $win );\r\n                            $win.bind( 'scroll', that._ie6Fix );\r\n                        }else{\r\n                            that.$el.addClass( 'xcy-fixed' );\r\n                            // that.$proxy.css( 'position', 'fixed' );\r\n                        }\r\n\r\n                    // parent is not body\r\n                    }else{\r\n                        // container fixed\r\n                        that._ie6Fix = that._topFixed( that.$parent );\r\n                        // scroll event\r\n                        that.$parent.bind( 'scroll', that._ie6Fix );\r\n                    }\r\n                }\r\n                // set shade layer the height\r\n                // $( '#shade-layer-' + that._cid ).css( 'height', that.$parent[0].scrollHeight );\r\n            // }\r\n\r\n            // ie6 bug\r\n            if( _isIE6 ){\r\n                // iframe mask ie6 select tag bug\r\n                that._ie6SelectFix();\r\n            }\r\n\r\n            // fixed and no move bind resize event of dialog\r\n            // 窗口大小改变事件\r\n            if( resize && (opt.fixed || !opt.isMove) ){\r\n                that._winResize = function(){\r\n\r\n                    opt.isMove && that._dragObj._size();\r\n                    // 获取layer位置\r\n                    var ph = that.parentHeight - that.warpperHeight,\r\n                        pw = that.parentWidth - that.warpperWidth,\r\n                        t = Number(that.top)/ph,\r\n                        l = Number(that.left)/pw;\r\n\r\n                    // debounce 防止resize执行过于频繁\r\n                    support.debounce( function(){\r\n                        \r\n                        that._getParentSize();\r\n                        // 刷新窗口重新计算layer位置\r\n                        var nph = that.parentHeight - that.warpperHeight,\r\n                            npw = that.parentWidth - that.warpperWidth,\r\n                            top = Math.round( t*nph ),\r\n                            left = Math.round( l*npw );\r\n\r\n                        // set layer css\r\n                        that.$el.css( that._setCss( top, left ) );\r\n                        // set proxy css\r\n                        that.$proxy && that.$proxy.css({\r\n                                top:  top,\r\n                                left: left \r\n                            })\r\n                        // set shade css\r\n                        if( showShade ){\r\n                            that._shadeCss( $( that.$elArr[0] ) );\r\n                        }\r\n                    })();\r\n                    // that.$parent.scroll();\r\n                };\r\n\r\n                if( that._isBody ){\r\n                    $win.bind( 'resize', that._winResize );\r\n                }else{\r\n                    // this.$parent.bind( 'resize', that._winResize );\r\n                }\r\n            }\r\n\r\n            // restore 记住原始大小和位置\r\n            that._restore = {top: that.top, left: that.left, height: that.height, width: that.width };\r\n\r\n            // drag layer move\r\n            if( opt.isMove ){\r\n                \r\n                // var timeStep;          \r\n                that._move();\r\n            }\r\n            // 层级冒泡排序\r\n            $el.bind('mousedown', function(){\r\n                // bubble z-index, set drag ladyer z-index\r\n                support.sort( id.split( '-' )[2] );\r\n            })\r\n            \r\n            // 监控加载状态\r\n            if( that.$iframe ){\r\n                var iframe = that.$iframe[0];\r\n                if( iframe.attachEvent ){\r\n                    iframe.attachEvent( \"onload\", function(){\r\n                        opt.onloadFn && opt.onloadFn();\r\n                        iframe.detachEvent( \"onload\", arguments.caller);\r\n                    });\r\n                }else{\r\n                    iframe.onload = function(){\r\n                        opt.onloadFn && opt.onloadFn();\r\n                        iframe.onload = null;\r\n                    };\r\n                }\r\n            }\r\n\r\n            // auto hidden\r\n            if( opt.delay )\r\n                that.timer = setTimeout( function(){ that._autoClose(); }, typeof opt.delay === 'boolean' ? 1800 : opt.delay );\r\n\r\n            // resize\r\n//             $el.addClass('xcy-resize');\r\n//             $el.delegate('.xcy-resize-item', 'mousedown', function(){\r\n//                 var $me = $(this),\r\n//                     id = $me.attr('id'),\r\n//                     // h = $win.innerHeight(),\r\n//                     // w = $win.innerWidth();\r\n//                     parentOffset = that.$parent.offset(),\r\n//                     parentTop = parentOffset.top,\r\n//                     parentLeft = parentOffset.left;\r\n//                     // oldLeft = that.left;\r\n//                     that.$proxy.css({\r\n//                         top: that.top,\r\n//                         left: that.left\r\n//                     })\r\n\r\n//                 var offset = that.$proxy.offset(),\r\n//                     top = offset.top,\r\n//                     left = offset.left,\r\n//                     width = that.$proxy.width(),\r\n//                     height = that.$proxy.height();\r\n\r\n//                     // $(document).bind( 'mousemove', handleResize );\r\n//                     // $(document).bind( 'mouseup', unResize)\r\n                    \r\n//                     function handleResize( e ){\r\n//                         var type = e.type;\r\n\r\n//                         // var offset = $proxy.offset(),\r\n//                         //     top = offset.top,\r\n//                         //     left = offset.left;\r\n\r\n//                         // window capture focus\r\n//                         if( _isIE ){\r\n//                             $me.bind( 'losecapture', that._end );\r\n//                             $me[0].setCapture();\r\n//                         }else{\r\n//                             $doc.bind( 'blur', that._end );\r\n//                         }\r\n\r\n//                         // clear selected text\r\n//                         window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\r\n\r\n//                         switch(id){\r\n//                             case 'xcy-resize-tl':\r\n//                                 break;\r\n//                             case 'xcy-resize-tc':\r\n//                                 break;\r\n//                             case 'xcy-resize-tr':\r\n//                                 break;\r\n//                             case 'xcy-resize-cl':\r\n//                                 // console.log(left, oldLeft);\r\n//                                 if(e.clientX < parentLeft) return;\r\n//                                 if(e.clientX > left+width-150) return;\r\n// console.log(left );\r\n//                                 // var cssPosition = that._dragObj.range(top, e.clientX - parentLeft, width + (left - e.clientX), height) \r\n//                                 that.$proxy.css({\r\n//                                     display: 'block',\r\n//                                     left: cssPosition.left,\r\n//                                     width: cssPosition.width\r\n//                                 })\r\n//                                 // that.resize( (that.width + that.left - e.clientX)+left, that.height, that.top, e.clientX-left)\r\n//                                 break;\r\n//                             case 'xcy-resize-cr':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                             case 'xcy-resize-bl':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                             case 'xcy-resize-bc':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                             case 'xcy-resize-br':\r\n//                                 if(e.clientX > that.parentWidth + left-6) return;\r\n//                                 // that.resize( e.clientX - (that.left) - left, that.height, that.top, that.left)\r\n//                                 break;\r\n//                         }\r\n                        \r\n//                         // if(e.clientX <= 20) return;\r\n\r\n//                         // that.resize( (that.width + that.left - (e.clientX ))+20, that.height, that.top, e.clientX-20)\r\n//                         // console.log(that.left, e.clientX, that.$parent.offset().left)\r\n\r\n//                         return false;\r\n//                     }\r\n\r\n//                     function unResize(){\r\n//                         $(document).unbind( 'mousemove', handleResize );\r\n//                         $(document).unbind( 'mouseup', unResize );\r\n\r\n//                         var offset = that.$proxy.position();\r\n//                         console.log(offset.top, offset.left, '---++++---')\r\n\r\n//                         that.resize( that.$proxy.width(), that.$proxy.height(), offset.top, offset.left, true )\r\n//                         that.$proxy.hide();\r\n//                     }\r\n//             })\r\n\r\n        },\r\n        _autoClose: function(){\r\n            var that = this,\r\n                len = that.$elArr.length - 1;\r\n\r\n            that.closed = true;\r\n\r\n            $.each( that.$elArr, function( i, v ){\r\n                $( v ).animate({opacity: '0'}, 800, function(){ \r\n                    i == len && that.close(); \r\n                });\r\n            });\r\n        },\r\n        _bindShadeClose: function( parent ){\r\n            var that = this,\r\n                $el = $( '.xcy-shade', that.$parent );\r\n\r\n            $el && $el.bind( 'click', function( e ){\r\n                if( that.closed ) return;\r\n                that.close();\r\n            });\r\n        },\r\n        _getContent: function(){\r\n\r\n            return $( '.xcy-content', this.$el );\r\n        },\r\n        _getTitle: function(){\r\n\r\n            return $( '.xcy-title', this.$el );\r\n        },\r\n        _getFoot: function(){\r\n\r\n            return $( '.xcy-foot', this.$el );\r\n        },\r\n        // html render\r\n        _layerHtml: function( title, content, buttonArr ){\r\n            var that = this,\r\n                opt = that.options,\r\n                type = that.type,\r\n                $el = that.$el,\r\n                cssObj = that.css,\r\n                isTitle = title !== false,\r\n                tit, con, btn, winBtn,\r\n                animateCss, animateAlign;\r\n\r\n            opt.title = title;\r\n            // get parent size \r\n            that._getParentSize();\r\n            // title\r\n            if( isTitle ){\r\n                \r\n                tit = that._titHtml( title );\r\n                \r\n                // render title\r\n                $( '.xcy-layer', $el ).append( tit );\r\n            }\r\n\r\n            // content\r\n            if( type == 'load' ){\r\n\r\n                con = that._loadHtml( content );\r\n            }else if( type == 'iframe' ){\r\n                \r\n                con = that._iframeHtml( opt.src );           \r\n            }else{\r\n                if( type == 'prompt' ){\r\n                    con = that._conHtml( '<div class=\"xcy-text\">'\r\n                        + '</div><input class=\"xcy-input\" type=\"text\" value=\\\"' + opt.value + '\\\" />' );\r\n\r\n                    con.find( '.xcy-text' ).html( content );\r\n                }else{\r\n                    con = that._conHtml( content );\r\n                }\r\n\r\n                // 宽高设置xcy-main层\r\n                // 自定义css 设置在xyc-main-inner层\r\n                $( '.xcy-main', con ).css( cssObj ); \r\n            }\r\n\r\n            // render content\r\n            $( '.xcy-layer', $el ).append( con );\r\n\r\n            // append dialog\r\n            // 按钮要焦点 需要先渲染\r\n            that.$parent.append( $el );\r\n\r\n            // buttons element\r\n            if( buttonArr ){\r\n                btn = that._btnHtml( buttonArr );\r\n\r\n                // render buttons\r\n                $( '.xcy-layer', $el ).append( btn );\r\n            }\r\n\r\n            // window controll buttons\r\n            if( type !== 'load' && opt.closeBtn ){\r\n                winBtn = that._winBtnHtml( type );\r\n                // render window buttons\r\n                $( '.xcy-layer', $el ).append( winBtn );\r\n\r\n            }   \r\n            // 转换宽高为数字\r\n            that._toNumberW( opt.width );\r\n            that._toNumberH( opt.height );      \r\n\r\n            // set content css\r\n            that._setCssSize( that._getContent() );\r\n\r\n            // get warpper size\r\n            that._getWarpperSize( $el );\r\n\r\n            // set warpper css position\r\n            if( opt.animate ){\r\n                animateCss = {};\r\n                animateAlign = opt.animateAlign;\r\n                if( animateAlign == 'bottom' ){\r\n                    animateCss = {\r\n                        top: that.parentHeight + that.warpperHeight,\r\n                        left: support.toNumber(opt.left, that.parentWidth - that.warpperWidth)\r\n                    }\r\n                }else if( animateAlign == 'top' ){\r\n                    animateCss = {\r\n                        top: -that.parentHeight,\r\n                        left: support.toNumber(opt.left, that.parentWidth - that.warpperWidth)\r\n                    }\r\n                }else if( animateAlign == 'left' ){\r\n                    animateCss = {\r\n                        top: support.toNumber(opt.top, that.parentHeight - that.warpperHeight),\r\n                        left: -that.warpperWidth\r\n                    }\r\n                }else if( animateAlign == 'right' ){\r\n                    animateCss = {\r\n                        top: support.toNumber(opt.top, that.parentHeight - that.warpperHeight),\r\n                        left: that.parentWidth + that.warpperWidth\r\n                    }\r\n                }\r\n                $el.css( animateCss );\r\n\r\n                $el.animate( that._setCss(opt.top, opt.left), opt.delay );\r\n            }else{\r\n                $el.css( that._setCss(opt.top, opt.left), opt.delay );\r\n            }\r\n\r\n            // button focus\r\n            try {\r\n                if( buttonArr ) that.$focus.focus();\r\n            }catch( e ){}\r\n        },\r\n        // shade html\r\n        _shadeHtml: function( id ){\r\n            var that = this,\r\n                shade = $( '<div class=\"xcy-shade\" id=\\\"'+ id +'\\\"></div>' );\r\n\r\n            that._shadeCss( shade );\r\n            that.$shade = shade;\r\n            // set id\r\n            // shade.css( { width: width, height: height, opacity: opacity, 'z-index': that._zIndex } );\r\n\r\n            that.$parent.append( shade );\r\n        },\r\n        _shadeCss: function( el ){\r\n            var that = this,\r\n                opacity = that.options.opacity,\r\n                isBody = that._isBody,\r\n                width = isBody ? $('body').outerWidth() : that.$parent[0].scrollWidth,\r\n                height = isBody ? $doc.innerHeight() : that.$parent[0].scrollHeight;\r\n\r\n            // that._getParentSize();\r\n            // set shade css\r\n            el.css( { width: width, height: height, opacity: opacity, 'z-index': that._zIndex } );\r\n        },\r\n        // load html\r\n        _loadHtml: function( html ){\r\n            var that = this,\r\n                opt = that.options,\r\n                node = $( '<div class=\"xcy-load\"><span class=\"xcy-load-img\"></span><span>'+html+'</span></div>' );\r\n\r\n            // 转换宽高为数字\r\n            that._toNumberW( opt.width );\r\n            that._toNumberH( opt.height ); \r\n            // set content css\r\n            that._setCssSize( node );\r\n\r\n            return node;\r\n        },\r\n        _iframeHtml: function( src ){\r\n            var that = this,\r\n                opt = that.options,\r\n                $iframe = $('<iframe allowtransparency=\"true\" frameborder=\"0\" class=\"xcy-iframe\" name=\"xcy-iframe-' \r\n                    + that._cid +'\"  src=\"'+src+'\" scrolling=\"'+opt.scrolling+'\"></iframe>');\r\n\r\n                // 添加 iframe 对象\r\n                that.$iframe = $iframe;\r\n\r\n            return that._conHtml( '' ).html( $iframe );\r\n        },\r\n        // content html\r\n        _conHtml: function( html ){\r\n            var that = this,\r\n                opt = that.options,\r\n                node = $( '<div class=\"xcy-content\"><div class=\"xcy-main\"></div></div>' ),\r\n                display, prev, next, parent;\r\n\r\n            // element remove save node info \r\n            if( html && html.nodeType === 1 ){\r\n                display = html.style.display;\r\n                prev = html.previousSibling;\r\n                next = html.nextSibling;\r\n                parent = html.parentNode;\r\n                that._elemBack = function () {\r\n                    if (prev && prev.parentNode) {\r\n                        prev.parentNode.insertBefore( html, prev.nextSibling);\r\n                    } else if (next && next.parentNode) {\r\n                        next.parentNode.insertBefore( html, next);\r\n                    } else if (parent) {\r\n                        parent.appendChild( html );\r\n                    }\r\n                    html.style.display = display;\r\n                    that._elemBack = null;\r\n                };\r\n            }\r\n\r\n            // set content html\r\n            node.find( '.xcy-main' ).html( html );\r\n            // add icon\r\n            if( opt.icon ){\r\n                node.addClass('xcy-icon-box')\r\n                node.append('<div class=\"xcy-icon-default xcy-icon-'+opt.icon+'\"></div>')\r\n            }\r\n\r\n            return node;\r\n        },\r\n        // title html\r\n        _titHtml: function( title ){\r\n            var that = this,\r\n                node = $( '<div class=\"xcy-title\"></div>' );\r\n\r\n            node.append( '<span title=\\\"'+ title +'\\\">'+ title +'</span>' );\r\n\r\n            return node;\r\n        },\r\n        // button html\r\n        _btnHtml: function( buttonArr ){\r\n            var that = this,\r\n                node = $( '<div class=\"xcy-foot\"></div>' ),\r\n                html = '',\r\n                len = buttonArr.length - 1;\r\n\r\n            // button html\r\n            $.each( buttonArr, function( i, v ){\r\n                var disabled = v.disabled ? 'disabled' : '',\r\n                    className = '';\r\n                if( i === 0 ){\r\n                    className = 'xcy-btn-r';\r\n                }else if( i == len ){\r\n                    className = 'xcy-btn-l';\r\n                }else{\r\n                    className = 'xcy-btn-m';\r\n                }\r\n                html += '<button class=\"xcy-btn '+ className +'\" type=\"button\" '+ disabled +'>'+ v.name +'</button>';\r\n            });\r\n\r\n            // button html\r\n            node.html( html );\r\n            // text align direction\r\n            node.css( 'text-align', that.options.align );\r\n\r\n            // bind callback event\r\n            $( 'button', node ).each(function(i){\r\n                var $ele = $( this ),\r\n                    obj = buttonArr[ i ],\r\n                    isReturn, callback, val;\r\n\r\n                $ele.click(function( e ){\r\n                    callback = obj.callback;\r\n                    val = $( '.xcy-input', that._getContent() ).val();\r\n\r\n                    // return callback\r\n                    if( callback ) isReturn = callback( $ele.text(), val );\r\n\r\n                    if( isReturn === false ){\r\n                        return;\r\n                    }else{\r\n                        that.close();\r\n                    }\r\n                });\r\n\r\n                // focus\r\n                if( obj.focus && !obj.disabled ){\r\n                    that.$focus = $ele;\r\n                }\r\n            })\r\n\r\n            return node;\r\n        },\r\n        _winBtnHtml: function( type ){\r\n            var that = this,\r\n                opts = that.options,\r\n                closeBtn = opts.closeBtn,\r\n                winBtn = opts.winBtn,\r\n                node = $( '<div class=\"xcy-winBtn\"></div>' ),\r\n                state = true,\r\n                msgClass = 'xcy-close-btn';\r\n\r\n            // min max\r\n            if( type == 'iframe' && winBtn ){\r\n                node.append( '<a class=\"xcy-winBtn-btn\" id=\"xcy-min-btn\" href=\"javascript:;\">-</a>' );\r\n                node.append( '<a class=\"xcy-winBtn-btn\" id=\"xcy-full-btn\" href=\"javascript:;\">+</a>' );\r\n            }\r\n            // if type is msg or page, change close class\r\n            if( ( type == 'msg' && opts.title === false ) || (type == 'page' && opts.title === false) )\r\n                msgClass = 'xcy-x-btn';\r\n            \r\n            // close\r\n            node.append( '<a class=\"xcy-winBtn-btn\"  id=\\\"'+ msgClass +'\\\" href=\"javascript:;\">×</a>' );\r\n\r\n            $( 'a', node ).bind( 'click', function( e ){\r\n                var id = $( this ).attr( 'id' ),\r\n                    isReturn = true;\r\n\r\n                switch( id ){\r\n                    case 'xcy-close-btn':\r\n                    case 'xcy-x-btn':\r\n                        // return callback\r\n                        if( closeBtn ) isReturn = closeBtn( that.title() );\r\n\r\n                        if( isReturn === false ){\r\n                            return;\r\n                        }else{\r\n                            that.close();\r\n                        }\r\n                        break;\r\n                    case 'xcy-full-btn':\r\n                        // if( state ){\r\n                            that.full();\r\n                            $( this ).attr( 'id', 'xcy-restore-btn' )\r\n                            $( '#xcy-min-btn', that.$el ).show();\r\n                            // state = false;\r\n                        // }else{\r\n                        //     $( '#xcy-min-btn', that.$el ).show();\r\n                        //     that.restore();\r\n                        //     state = true;\r\n                        // }\r\n                        break;\r\n                    case 'xcy-restore-btn':\r\n                        that.restore();\r\n                        $( this ).attr( 'id', 'xcy-full-btn' )\r\n                        $( '#xcy-min-btn', that.$el ).show();\r\n                        break;\r\n                    case 'xcy-min-btn':\r\n                        $( this ).hide();\r\n                        that.min();\r\n                        $( this ).next().attr( 'id', 'xcy-restore-btn' )\r\n                        break;\r\n                }\r\n            });\r\n\r\n            return node;\r\n        },\r\n        _move: function(){\r\n            var that = this,\r\n                opt = that.options,\r\n                _drag = opt.drag,\r\n                $el = that.$el;\r\n\r\n            // set drag value\r\n            $.extend( _drag, {\r\n                selector: that.$proxy,\r\n                container: opt.container,\r\n                fixed: opt.fixed,\r\n                target: $('.xcy-title', $el),\r\n                isBody: that._isBody\r\n            })\r\n            _drag.onStart = function( $drag ){\r\n                // $drag.css({ top: that.top, left: that.left })\r\n                $el.hide();\r\n            };\r\n            var onMove = _drag.onMove;\r\n            _drag.onMove = function( t, l ){\r\n                // clearTimeout(timeStep)\r\n                // showProxy()\r\n                that.top = t;\r\n                that.left = l;\r\n                onMove( t, l );\r\n            };\r\n            _drag.onEnd = function( t, l ){\r\n                that.$el.css({ top: t, left: l })\r\n                // set _restore 修改原始位置\r\n                that._restore.top = t;\r\n                that._restore.left = l;\r\n                $el.show();\r\n            };\r\n\r\n            // drag drop init\r\n            that._dragObj = new DragDrop( _drag );\r\n        },\r\n        _topFixed: function( parent ){\r\n            var that = this,\r\n                _top, Fix;\r\n\r\n            // client top\r\n            Fix = function(){\r\n                \r\n                support.debounce( function(){\r\n                    that.$el.css({\r\n                        top: that.top + parent.scrollTop(),\r\n                        left: that.left + parent.scrollLeft()\r\n                    })\r\n                    // that.$el.animate({\r\n                    //     top: that.top + parent.scrollTop(),\r\n                    //     left: that.left + parent.scrollLeft()\r\n                    // })  \r\n                })();\r\n            };\r\n\r\n            return Fix;\r\n        },\r\n        // ie6 select not mask with div tag\r\n        _ie6SelectFix: function(){\r\n            var that = this,\r\n                $el = that.$el,\r\n                width = that.warpperWidth,\r\n                height = that.warpperHeight,\r\n                iframe;\r\n\r\n            // iframe = $el.append(document.createElement('iframe'));\r\n            iframe = document.createElement('iframe');\r\n            iframe.src = 'about:blank;';\r\n            iframe.style.cssText = 'position:absolute;z-index:-1;left:0;top:0;'\r\n            + 'filter:alpha(opacity=0);border:0 none;width:' + width + 'px;height:' + height +'px;';\r\n\r\n            $el.append( iframe );\r\n        },\r\n        // 宽度百分比转换数字\r\n        _toNumberW: function( w ){\r\n            var that = this,\r\n                conW, //内容宽\r\n                overW;\r\n\r\n            // warpper 大小\r\n            that._getWarpperSize( that.$el );\r\n\r\n            that._getConWidth();\r\n           \r\n            // % percent conver to number\r\n            if( w ){\r\n                if( String(w).indexOf('%') !== -1 ){\r\n                    conW = that.width;\r\n                    overW = that.warpperWidth - conW;\r\n                    w = support.toNumber( w, that.parentWidth -overW );\r\n                }\r\n                that.width = Number(w);\r\n            }\r\n        },\r\n        // 高度百分比转换数字\r\n        _toNumberH: function( h ){\r\n            var that = this,\r\n                conH, //内容宽\r\n                overH;\r\n\r\n            // warpper 大小\r\n            that._getWarpperSize( that.$el );\r\n\r\n            that._getConHeight();\r\n\r\n            // % percent conver to number\r\n            if( h ){\r\n                if( String(h).indexOf('%') !== -1 ){\r\n                    conH = that.height;\r\n                    overH = that.warpperHeight - conH;\r\n                    h = support.toNumber( h, that.parentHeight -overH );\r\n                }\r\n                that.height = Number(h);\r\n            }\r\n        },\r\n        // set content css\r\n        _setCssSize: function( el ){\r\n            var that = this,\r\n                cssObj = that.css;\r\n\r\n            // 宽高分开渲染，不然高度受宽度影响获取值不对\r\n            // that._toNumberW( w );\r\n            el.css( { width: that.width, height: that.height } );\r\n\r\n            // that._toNumberH( h );\r\n            // el.css( { height: that.height } );\r\n        },\r\n        // set warpper css\r\n        _setCss: function( t, l ){\r\n            var that = this,\r\n                opt = that.options,\r\n                $parent = that.$parent,\r\n                isBody = that._isBody,\r\n                dt = 0,\r\n                dl = 0,\r\n                cssObj = {};\r\n\r\n            if( opt.fixed && _isIE6 ){\r\n                dt = isBody ? $doc.scrollTop() : that.$parent.scrollTop();\r\n                dl = isBody ? $doc.scrollLeft() : that.$parent.scrollLeft();\r\n            }\r\n\r\n            // top\r\n            if( t === undefined || t === '' ){\r\n                t = '50%';\r\n            }\r\n            // top % to number\r\n            t = support.toNumber( t, that.parentHeight - that.warpperHeight );\r\n            that.top = t;\r\n\r\n            // left\r\n            if( l === undefined || l === '' ){\r\n                l = '50%';\r\n            }\r\n            // left % to number\r\n            l = support.toNumber( l, that.parentWidth - that.warpperWidth );\r\n            that.left = l;\r\n\r\n            cssObj[ 'z-index' ] = that._zIndex;\r\n\r\n            cssObj[ 'top' ] = t + dt;\r\n            cssObj[ 'left' ] = l + dl;\r\n\r\n            return cssObj;\r\n        },\r\n        // 获取dialog content容器宽度\r\n        _getConWidth: function(){\r\n            var that = this;\r\n\r\n            that.width = that._getContent().width();\r\n        },\r\n        // 获取dialog content容器高度\r\n        _getConHeight: function(){\r\n            var that = this;\r\n\r\n            that.height = that._getContent().height();\r\n        },\r\n        // 获取dialog父级可视大小\r\n        _getParentSize: function(){\r\n            var that = this,\r\n                opt = that.options,\r\n                $parent = that.$parent,\r\n                isBody = that._isBody;\r\n\r\n            // this.parentWidth = isClient ? ( document.documentElement.clientWidth || document.body.clientWidth ) : $parent[0].clientWidth;\r\n            // this.parentHeight = isClient ? ( document.documentElement.clientHeight || document.body.clientHeight ) : $parent[0].clientHeight;\r\n            that.parentWidth = isBody ? $win.innerWidth() : $parent[0].clientWidth;\r\n            that.parentHeight = isBody ? $win.innerHeight() : $parent[0].clientHeight;\r\n        },\r\n        // 获取dialog大小\r\n        _getWarpperSize: function( el ){\r\n            this.warpperWidth = el.outerWidth();\r\n            this.warpperHeight = el.outerHeight();\r\n        },\r\n        min: function(){\r\n\r\n            this.resize( '180', '0', this.top, this.left );\r\n        },\r\n        full: function(){\r\n\r\n            this.resize( '100%', '100%', 0, 0 );\r\n        },\r\n        restore: function(){\r\n            var that = this,\r\n                restore = that._restore;\r\n\r\n            that.resize( restore.width, restore.height, restore.top, restore.left );\r\n        },\r\n        title: function( title ){\r\n            var el = this._getTitle().children( 'span' );\r\n\r\n            var newTitle = title ? el.html( title ) : el.html();\r\n\r\n            return title ? this : newTitle;\r\n        },\r\n        html: function( html ){\r\n            this._getContent().html( html );\r\n\r\n            return this;\r\n        },\r\n        buttons: function( buttonArr ){\r\n            $( 'button', this.$el ).unbind( 'click' );\r\n            this._getFoot().replaceWith( this._btnHtml( buttonArr ) );\r\n\r\n            return this;\r\n        },\r\n        resize: function( w, h, t, l, isdrag ){\r\n            var that = this,\r\n                offL = parseInt( that.$el.css( 'left' ) ),  //left\r\n                offT = parseInt( that.$el.css( 'top' ) ),\r\n                conW, conH, //内容宽\r\n                diffH, diffW,\r\n                overH, overW,\r\n                left, top, box;\r\n\r\n            // restore\r\n            // that._restore = {top: that.top, left: that.left, height: that.height, width: that.width };\r\n\r\n            // 宽高转换数字\r\n            that._toNumberW( w );\r\n            that._toNumberH( h );\r\n\r\n            conW = that.width, //内容宽\r\n            conH = that.height,\r\n\r\n            this.options.height = h;\r\n            this.options.width = w;            \r\n\r\n            // 除内容外的宽度/2\r\n            // diffW = (conW - w)/2;\r\n            // diffH = (conH - h)/2;\r\n            // // exist l and t 指定位置\r\n            // // no exist [ offL + diffW ]\r\n            // left = l !== undefined ? l : offL + diffW;\r\n            // top = t !== undefined ? t : offT + diffH;\r\n           \r\n            // t = that.oTop;\r\n            // l = that.oLeft;\r\n            \r\n// console.log( that._restore );\r\n\r\n            // set content css\r\n            that._setCssSize( that._getContent() );\r\n            // reset warpper size\r\n            that._getWarpperSize( that.$el );\r\n            // exist l and t 指定位置\r\n            // no exist [ offL + diffW ]\r\n            box = that._setCss( t, l );\r\n            top = box.top;\r\n            left = box.left;\r\n\r\n            that.$proxy.css({\r\n                left: left,\r\n                top: top,\r\n                width: that.warpperWidth,\r\n                height: that.warpperHeight\r\n            })\r\n\r\n            // move positon\r\n            // if( !this._dragObj || isdrag ){\r\n                // console.log( top, left, that.warpperHeight, that.warpperWidth )\r\n                // that.$el.css( that._setCss( top, left ) );\r\n                that.$el.css({\r\n                    top: top,\r\n                    left: left\r\n                });\r\n            // }else{\r\n                // that._dragObj._move( top, left, that.warpperHeight, that.warpperWidth );\r\n                // that._dragObj._end( top, left );\r\n            // }\r\n\r\n            return this;\r\n        },\r\n        moveTo: function( t, l ){\r\n            var that = this;\r\n\r\n            // % percent conver to number\r\n            t = support.toNumber( t, that.parentHeight );\r\n            l = support.toNumber( l, that.parentWidth );\r\n\r\n            // get drag layer limit range\r\n            if( !this._dragObj ){\r\n                box = that._setCss( t, l );\r\n            }else{\r\n                box = that._dragObj.range( t, l, that.warpperWidth, that.warpperHeight );\r\n            }\r\n\r\n            // set warpper css\r\n            that.$el.css( that._setCss( box.top, box.left ) );\r\n\r\n            return this;\r\n        },\r\n        setDrag: function( o ){\r\n            if( !this._dragObj ) return this;\r\n\r\n            this._dragObj.set( o );\r\n\r\n            return this;\r\n        },\r\n        hide: function(){\r\n            $.each( this.$elArr, function( i, v ){\r\n                $( v ).hide();\r\n            })\r\n\r\n            return this;\r\n        },\r\n        show: function(){\r\n            $.each( this.$elArr, function( i, v ){\r\n                $( v ).show();\r\n            })\r\n\r\n            return this;\r\n        },\r\n        close: function(){\r\n            var that = this;\r\n\r\n            if( that.timer ){\r\n                clearTimeout( that.timer )\r\n                that.timer = null;\r\n            }\r\n            that.closed = null;\r\n\r\n            // not unload\r\n            if( !that.options.unload ){\r\n                that.hide();\r\n                return;\r\n            }\r\n\r\n            // unload\r\n            that.unload();\r\n        },\r\n        unload: function(){\r\n            var that = this, t;\r\n\r\n            // unbind input buttons click event\r\n            $( 'button', that.$el ).unbind( 'click' );\r\n            $( '.xcy-winBtn a', that.$el ).unbind( 'click' );\r\n            that.$el.unbind( 'mousedown' );\r\n\r\n            // unbind window event\r\n            if( that._winResize ){\r\n                $win.unbind( 'resize', that._winResize );\r\n            }\r\n            if( that._ie6Fix ){\r\n                $win.unbind( 'scroll', that._ie6Fix );\r\n                that.$parent.unbind( 'scroll', that._ie6Fix ); \r\n            }\r\n            \r\n            // unbind shade\r\n            that.options.shadeClose && $( '.xcy-shade', that.$parent ).unbind( 'click' );\r\n\r\n            // unbind drag click event\r\n            that.options.isMove && that._dragObj.disable();\r\n            // if html is element, back move position\r\n            that._elemBack && that._elemBack();\r\n\r\n            // 低版本ie 内存回收 iframe\r\n            if( that.type === 'iframe' ){\r\n                try {\r\n                    var iframe = that.$iframe[0];\r\n                    iframe.contentWindow.document.write('');\r\n                    iframe.contentWindow.close();\r\n                    that.$iframe.remove();\r\n                } catch(e){}\r\n            }\r\n            // remove dom\r\n            $.each( that.$elArr, function( i, v ){\r\n                $( v ).remove();\r\n            })\r\n            that.$elArr = null;\r\n            that.$proxy.remove();\r\n            that.$proxy = null;\r\n\r\n            // delete global array object\r\n            t = layers.length;\r\n            while( t-- ){\r\n                if( layers[ t ]._cid === this._cid ){\r\n                    layers.splice( t, 1 );\r\n                }\r\n            }\r\n\r\n        },\r\n        closeAll: function(){\r\n            $.each( layers, function( i, v ){\r\n                v.close();\r\n            })\r\n        }\r\n    }\r\n\r\n    // drag layer\r\n    var DragDrop = (function( options ){\r\n\r\n        /**\r\n         * [dragdrop description]\r\n         * @param  {[type]} options [description]\r\n         * @return {[type]}         [description]\r\n         */\r\n        function dragdrop( options ){\r\n            var that = this;\r\n\r\n            that.diffx = 0;\r\n            that.diffy = 0;\r\n            that.options = options;\r\n            that.$drag = typeof options.selector === 'string' ? $( options.selector ) : options.selector;\r\n            that.$target = typeof options.selector === 'string' ? $( options.target ) : options.target;\r\n            that._handleEvent = _handleEvent;\r\n\r\n            that._init();\r\n\r\n            // handle event\r\n            function _handleEvent( e ){\r\n                var type = e.type,\r\n                    _self = that,\r\n                    $target = $( e.target ),\r\n                    className = that.$target.attr('class'),\r\n                    $el;\r\n\r\n                // target is tit childer\r\n                if( $target.parents( '.xcy-drag' ).length !== 0 ){\r\n                    $el = $target.parents( '.xcy-drag' );\r\n                // target is tit\r\n                }else{\r\n                    $el = $target;\r\n                }\r\n\r\n                switch( type ){\r\n                    case 'mousedown':\r\n                        // bind start event\r\n                        that.options.onStart( that.$drag );\r\n\r\n                        if( $el.hasClass( 'xcy-drag' ) ){\r\n\r\n                            that.$drag.removeClass('xcy-proxy-hidden');\r\n                            // console.log(that.$target[0].getBoundingClientRect())\r\n                            // mouse clientx - drag layer offset left\r\n                            that.diffx = e.clientX - that.$drag[0].offsetLeft;\r\n                            that.diffy = e.clientY - that.$drag[0].offsetTop;\r\n                            // afresh size\r\n                            that._getOffSize();\r\n                   \r\n                            // clear selected text\r\n                            window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\r\n                            \r\n                            // window capture focus\r\n                            if( _isIE ){\r\n                                that.$drag.bind( 'losecapture', that._end );\r\n                                that.$drag[0].setCapture();\r\n                            }else{\r\n                                $doc.bind( 'blur', that._end );\r\n                            }\r\n\r\n                            $doc.bind( 'mousemove', that._handleEvent );\r\n                            $doc.bind( 'mouseup', that._handleEvent );\r\n\r\n                            e.preventDefault();\r\n                        }\r\n                        break;\r\n                    case 'mousemove':\r\n                        var l = e.clientX - that.diffx,\r\n                            t = e.clientY - that.diffy;\r\n\r\n                        that._move( t, l, that.dragH, that.dragW );\r\n\r\n                        e.preventDefault();\r\n                        break;\r\n                    case 'mouseup':\r\n                        // dragable proxy hidden\r\n                        that.$drag.addClass('xcy-proxy-hidden');\r\n\r\n                        that._end();\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        dragdrop.prototype = {\r\n            _init: function(){\r\n                var that = this;\r\n\r\n                that._size();\r\n\r\n                // $tit.attr( 'data-move', 'true' );\r\n                // $tit.css( 'cursor', 'move' );\r\n                that.$target.addClass( 'xcy-drag' );\r\n                // mousedown event\r\n                that.$target.bind( 'mousedown', that._handleEvent );\r\n            },\r\n            _getActive: function () {\r\n                try {// try: ie8~9, iframe bug\r\n                    var activeElement = document.activeElement,\r\n                        contentDocument = activeElement.contentDocument,\r\n                        elem = contentDocument && contentDocument.activeElement || activeElement;\r\n                    return elem;\r\n                } catch (e) {}\r\n            },\r\n            _size: function(){\r\n                var that = this,\r\n                    opt = that.options,\r\n                    range = opt.range,\r\n                    $container;\r\n\r\n                // limit range\r\n                if( !opt.limit ) return;\r\n\r\n                that.mxT = range[0];\r\n                that.mxR = range[1] !== undefined ? range[1] : range[0];\r\n                that.mxB = range[2] !== undefined ? range[2] : range[0];\r\n                that.mxL = range[3] !== undefined ? range[3] : range[1] ? range[1] : range[0];\r\n\r\n                // that.marginL = parseInt( that.$parent.css( 'marginLeft' ) );\r\n                // that.marginT = parseInt( that.$parent.css( 'marginTop' ) );\r\n\r\n                that._getOffSize();\r\n\r\n                // container\r\n                // if( opt.container ){\r\n                    // $container = opt.fixed ? $( 'body' ) : $( opt.container );\r\n                    $container = $( opt.container );\r\n\r\n                    // client element 可视范围dom对象\r\n                    if( !opt.fixed && opt.isBody ){\r\n                        // scroll range value值\r\n                        that.h = $doc.outerHeight();\r\n                        that.w = $doc.outerWidth();\r\n\r\n                    }else if( opt.fixed && opt.isBody ){\r\n                        that.h = $win.innerHeight();\r\n                        that.w = $win.innerWidth();\r\n\r\n                    }else{\r\n                        // client range value值\r\n                        that.h = $container[0].scrollHeight;\r\n                        that.w = $container[0].scrollWidth;\r\n                    }\r\n\r\n                    // container css style position\r\n                    $container.css( 'position' ) == 'relative' && $container.css( 'position', 'relative' );\r\n\r\n                // }\r\n\r\n                // lock x axis\r\n                if( opt.lockX ) that.mxR = that.mxL = that.left;\r\n                // lock y axis\r\n                if( opt.lockY ) that.mxT = that.mxB = that.top;\r\n            },\r\n            _getOffSize: function(){\r\n                var that = this;\r\n\r\n                // get parent width and height value\r\n                that.dragW = that.$drag.outerWidth();\r\n                that.dragH = that.$drag.outerHeight();\r\n                // left top\r\n                that.left = parseInt( that.$drag.css( 'left' ) );\r\n                that.top = parseInt( that.$drag.css( 'top' ) );\r\n\r\n                // reprai 修正右下limit range值\r\n                // limit right值: 右限制最大值\r\n                // limit left值 + 拖动容器width值: 右限制范围最小值\r\n                that.mxR = Math.max( that.mxR, that.mxL + that.dragW );\r\n                that.mxB = Math.max( that.mxB, that.mxT + that.dragH );\r\n            },\r\n            _move: function( t, l, dragH, dragW ){\r\n                var that = this,\r\n                    position, left, top;\r\n\r\n                // left and top value\r\n                position = that.range( t, l, dragW, dragH );\r\n                left = position.left;\r\n                top = position.top;\r\n\r\n                that.$drag.css( { 'left': left, 'top': top } );\r\n                that.left = left;\r\n                that.top = top;\r\n\r\n                that.options.onMove( top, left );\r\n            },\r\n            // drag end, unbind event\r\n            _end: function(){\r\n                var that = this;\r\n\r\n                $doc.unbind( 'mousemove', that._handleEvent );\r\n                $doc.unbind( 'mouseup', that._handleEvent );\r\n\r\n                if( _isIE ){\r\n                    that.$drag.unbind( 'losecapture', that._end );\r\n                    that.$drag[0].releaseCapture();\r\n                }else{\r\n                    $doc.unbind( 'blur', that._end );\r\n                }\r\n\r\n                that.options.onEnd(that.top, that.left);\r\n            },\r\n            range: function( t, l, dragW, dragH ){\r\n                var that = this,\r\n                    opt = that.options,\r\n                    obj = {},\r\n                    mxT, mxR, mxL, mxB;\r\n\r\n                // scroll top\r\n                // if( !opt.fixed ){\r\n                //     st = $doc.scrollTop();\r\n                //     sl = $doc.scrollLeft();\r\n                // }\r\n\r\n                if( opt.limit ){\r\n\r\n                    mxT = that.mxT;\r\n                    mxR = that.mxR;\r\n                    mxL = that.mxL;\r\n                    mxB = that.mxB;\r\n\r\n                    if( opt.container ){\r\n                        // [ limit range , container range ] 容器最小活动范围\r\n                        mxT = Math.max( that.mxT, 0 );\r\n                        mxR = Math.min( that.w - dragW, that.mxR - dragW );\r\n                        mxL = Math.max( that.mxL, 0 );\r\n                        mxB = Math.min( that.h - dragH, that.mxB - dragH );\r\n                    }\r\n\r\n                    // 获取drag时正确的范围值\r\n                    l = Math.max(Math.min( l, mxR ), mxL );\r\n                    t = Math.max(Math.min( t, mxB ), mxT );\r\n                }\r\n\r\n                obj.left = l;\r\n                obj.top = t;\r\n                obj.width = dragW;\r\n                obj.height = dragH;\r\n\r\n                return obj;\r\n            },\r\n            // set attribute options\r\n            set: function( options ){\r\n                var that = this;\r\n\r\n                options && $.extend( that.options, options );\r\n                that._size();\r\n            },\r\n            // bind event\r\n            enable: function(){\r\n                var that = this;\r\n\r\n                that.$drag.bind( 'mousedown', that._handleEvent );\r\n            },\r\n            // unbind event\r\n            disable: function(){\r\n                var that = this;\r\n\r\n                that.$drag.unbind( 'mousedown', that._handleEvent ); \r\n            }\r\n        }\r\n\r\n        return dragdrop;\r\n\r\n    })();\r\n\r\n    var dialog = {\r\n        create: function( options ){\r\n            var dl = new DialogLayer( options );\r\n            // save global dialog\r\n            // layers.push( dl );\r\n            return dl;\r\n        },\r\n        load: function( msg, delay, shade, shadeClose ){\r\n            // delay is not exist\r\n            return Dialog.create({\r\n                type: 'load',\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: shade || false,\r\n                shadeClose: shadeClose || true,\r\n                delay: typeof delay !== 'undefined' ? delay : false\r\n            })\r\n        },\r\n        prompt: function( msg, val, ok, cancel ){\r\n            return Dialog.create({\r\n                type: 'prompt',\r\n                html: msg,\r\n                value: val,\r\n                fixed: true,\r\n                width: 300,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: ok,\r\n                        disabled: false,\r\n                        focus: true\r\n                    },\r\n                    {\r\n                        name: '取消',\r\n                        callback: cancel,\r\n                        disabled: false,\r\n                        focus: false\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        confirm: function( msg, ok, cancel ){\r\n\r\n            return Dialog.create({\r\n                type: 'confirm',\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: ok,\r\n                        disabled: false,\r\n                        focus: true\r\n                    },\r\n                    {\r\n                        name: '取消',\r\n                        callback: cancel,\r\n                        disabled: false,\r\n                        focus: false\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        alert: function( msg, config, callback ){\r\n            // title is not exist\r\n            if( typeof config === 'function' ){\r\n                callback = config;\r\n                config = {};\r\n                config.title = Default.title;\r\n            }\r\n\r\n            return Dialog.create({\r\n                type: 'alert',\r\n                html: msg,\r\n                icon: config.icon || false,\r\n                fixed: true,\r\n                title: config.title,\r\n                unload: true,\r\n                shade: config.shade === false ? false : true,\r\n                buttons: [\r\n                    {\r\n                        name: '确定',\r\n                        callback: callback,\r\n                        disabled: false,\r\n                        focus: true\r\n                    }\r\n                ]\r\n            })\r\n        },\r\n        msg: function( msg, delay, shade ){\r\n            // delay is not exist\r\n            delay = typeof delay !== 'undefined' ? delay : true;\r\n\r\n            return Dialog.create({\r\n                type: 'msg',\r\n                title: false,\r\n                html: msg,\r\n                fixed: true,\r\n                unload: true,\r\n                shade: shade || false,\r\n                closeBtn: !delay ? function(){} : false,\r\n                delay: delay,\r\n                isMove: false\r\n            })\r\n        },\r\n        // config default param\r\n        config: function( config ){\r\n            return $.extend( Default, config );\r\n        }\r\n    }\r\n\r\n    'function' === typeof define? define(function(){\r\n        return dialog;\r\n    }) : window.Dialog = dialog;\r\n    \r\n})()"],"sourceRoot":"/source/"}